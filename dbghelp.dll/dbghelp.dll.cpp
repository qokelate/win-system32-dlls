#include <windows.h>
#include <shlwapi.h>

extern "C" {
extern void *ptr_DbgHelpCreateUserDump;
void *ptr_DbgHelpCreateUserDump = NULL;
extern void *ptr_DbgHelpCreateUserDumpW;
void *ptr_DbgHelpCreateUserDumpW = NULL;
extern void *ptr_EnumDirTree;
void *ptr_EnumDirTree = NULL;
extern void *ptr_EnumDirTreeW;
void *ptr_EnumDirTreeW = NULL;
extern void *ptr_EnumerateLoadedModules;
void *ptr_EnumerateLoadedModules = NULL;
extern void *ptr_EnumerateLoadedModules64;
void *ptr_EnumerateLoadedModules64 = NULL;
extern void *ptr_EnumerateLoadedModulesEx;
void *ptr_EnumerateLoadedModulesEx = NULL;
extern void *ptr_EnumerateLoadedModulesExW;
void *ptr_EnumerateLoadedModulesExW = NULL;
extern void *ptr_EnumerateLoadedModulesW64;
void *ptr_EnumerateLoadedModulesW64 = NULL;
extern void *ptr_ExtensionApiVersion;
void *ptr_ExtensionApiVersion = NULL;
extern void *ptr_FindDebugInfoFile;
void *ptr_FindDebugInfoFile = NULL;
extern void *ptr_FindDebugInfoFileEx;
void *ptr_FindDebugInfoFileEx = NULL;
extern void *ptr_FindDebugInfoFileExW;
void *ptr_FindDebugInfoFileExW = NULL;
extern void *ptr_FindExecutableImage;
void *ptr_FindExecutableImage = NULL;
extern void *ptr_FindExecutableImageEx;
void *ptr_FindExecutableImageEx = NULL;
extern void *ptr_FindExecutableImageExW;
void *ptr_FindExecutableImageExW = NULL;
extern void *ptr_FindFileInPath;
void *ptr_FindFileInPath = NULL;
extern void *ptr_FindFileInSearchPath;
void *ptr_FindFileInSearchPath = NULL;
extern void *ptr_GetTimestampForLoadedLibrary;
void *ptr_GetTimestampForLoadedLibrary = NULL;
extern void *ptr_ImageDirectoryEntryToData;
void *ptr_ImageDirectoryEntryToData = NULL;
extern void *ptr_ImageDirectoryEntryToDataEx;
void *ptr_ImageDirectoryEntryToDataEx = NULL;
extern void *ptr_ImageNtHeader;
void *ptr_ImageNtHeader = NULL;
extern void *ptr_ImageRvaToSection;
void *ptr_ImageRvaToSection = NULL;
extern void *ptr_ImageRvaToVa;
void *ptr_ImageRvaToVa = NULL;
extern void *ptr_ImagehlpApiVersion;
void *ptr_ImagehlpApiVersion = NULL;
extern void *ptr_ImagehlpApiVersionEx;
void *ptr_ImagehlpApiVersionEx = NULL;
extern void *ptr_MakeSureDirectoryPathExists;
void *ptr_MakeSureDirectoryPathExists = NULL;
extern void *ptr_MiniDumpReadDumpStream;
void *ptr_MiniDumpReadDumpStream = NULL;
extern void *ptr_MiniDumpWriteDump;
void *ptr_MiniDumpWriteDump = NULL;
extern void *ptr_SearchTreeForFile;
void *ptr_SearchTreeForFile = NULL;
extern void *ptr_SearchTreeForFileW;
void *ptr_SearchTreeForFileW = NULL;
extern void *ptr_StackWalk;
void *ptr_StackWalk = NULL;
extern void *ptr_StackWalk64;
void *ptr_StackWalk64 = NULL;
extern void *ptr_SymAddSourceStream;
void *ptr_SymAddSourceStream = NULL;
extern void *ptr_SymAddSourceStreamA;
void *ptr_SymAddSourceStreamA = NULL;
extern void *ptr_SymAddSourceStreamW;
void *ptr_SymAddSourceStreamW = NULL;
extern void *ptr_SymAddSymbol;
void *ptr_SymAddSymbol = NULL;
extern void *ptr_SymAddSymbolW;
void *ptr_SymAddSymbolW = NULL;
extern void *ptr_SymCleanup;
void *ptr_SymCleanup = NULL;
extern void *ptr_SymDeleteSymbol;
void *ptr_SymDeleteSymbol = NULL;
extern void *ptr_SymDeleteSymbolW;
void *ptr_SymDeleteSymbolW = NULL;
extern void *ptr_SymEnumLines;
void *ptr_SymEnumLines = NULL;
extern void *ptr_SymEnumLinesW;
void *ptr_SymEnumLinesW = NULL;
extern void *ptr_SymEnumProcesses;
void *ptr_SymEnumProcesses = NULL;
extern void *ptr_SymEnumSourceFileTokens;
void *ptr_SymEnumSourceFileTokens = NULL;
extern void *ptr_SymEnumSourceFiles;
void *ptr_SymEnumSourceFiles = NULL;
extern void *ptr_SymEnumSourceFilesW;
void *ptr_SymEnumSourceFilesW = NULL;
extern void *ptr_SymEnumSourceLines;
void *ptr_SymEnumSourceLines = NULL;
extern void *ptr_SymEnumSourceLinesW;
void *ptr_SymEnumSourceLinesW = NULL;
extern void *ptr_SymEnumSym;
void *ptr_SymEnumSym = NULL;
extern void *ptr_SymEnumSymbols;
void *ptr_SymEnumSymbols = NULL;
extern void *ptr_SymEnumSymbolsForAddr;
void *ptr_SymEnumSymbolsForAddr = NULL;
extern void *ptr_SymEnumSymbolsForAddrW;
void *ptr_SymEnumSymbolsForAddrW = NULL;
extern void *ptr_SymEnumSymbolsW;
void *ptr_SymEnumSymbolsW = NULL;
extern void *ptr_SymEnumTypes;
void *ptr_SymEnumTypes = NULL;
extern void *ptr_SymEnumTypesByName;
void *ptr_SymEnumTypesByName = NULL;
extern void *ptr_SymEnumTypesByNameW;
void *ptr_SymEnumTypesByNameW = NULL;
extern void *ptr_SymEnumTypesW;
void *ptr_SymEnumTypesW = NULL;
extern void *ptr_SymEnumerateModules;
void *ptr_SymEnumerateModules = NULL;
extern void *ptr_SymEnumerateModules64;
void *ptr_SymEnumerateModules64 = NULL;
extern void *ptr_SymEnumerateModulesW64;
void *ptr_SymEnumerateModulesW64 = NULL;
extern void *ptr_SymEnumerateSymbols;
void *ptr_SymEnumerateSymbols = NULL;
extern void *ptr_SymEnumerateSymbols64;
void *ptr_SymEnumerateSymbols64 = NULL;
extern void *ptr_SymEnumerateSymbolsW;
void *ptr_SymEnumerateSymbolsW = NULL;
extern void *ptr_SymEnumerateSymbolsW64;
void *ptr_SymEnumerateSymbolsW64 = NULL;
extern void *ptr_SymFindDebugInfoFile;
void *ptr_SymFindDebugInfoFile = NULL;
extern void *ptr_SymFindDebugInfoFileW;
void *ptr_SymFindDebugInfoFileW = NULL;
extern void *ptr_SymFindExecutableImage;
void *ptr_SymFindExecutableImage = NULL;
extern void *ptr_SymFindExecutableImageW;
void *ptr_SymFindExecutableImageW = NULL;
extern void *ptr_SymFindFileInPath;
void *ptr_SymFindFileInPath = NULL;
extern void *ptr_SymFindFileInPathW;
void *ptr_SymFindFileInPathW = NULL;
extern void *ptr_SymFromAddr;
void *ptr_SymFromAddr = NULL;
extern void *ptr_SymFromAddrW;
void *ptr_SymFromAddrW = NULL;
extern void *ptr_SymFromIndex;
void *ptr_SymFromIndex = NULL;
extern void *ptr_SymFromIndexW;
void *ptr_SymFromIndexW = NULL;
extern void *ptr_SymFromName;
void *ptr_SymFromName = NULL;
extern void *ptr_SymFromNameW;
void *ptr_SymFromNameW = NULL;
extern void *ptr_SymFromToken;
void *ptr_SymFromToken = NULL;
extern void *ptr_SymFromTokenW;
void *ptr_SymFromTokenW = NULL;
extern void *ptr_SymFunctionTableAccess;
void *ptr_SymFunctionTableAccess = NULL;
extern void *ptr_SymFunctionTableAccess64;
void *ptr_SymFunctionTableAccess64 = NULL;
extern void *ptr_SymGetFileLineOffsets64;
void *ptr_SymGetFileLineOffsets64 = NULL;
extern void *ptr_SymGetHomeDirectory;
void *ptr_SymGetHomeDirectory = NULL;
extern void *ptr_SymGetHomeDirectoryW;
void *ptr_SymGetHomeDirectoryW = NULL;
extern void *ptr_SymGetLineFromAddr;
void *ptr_SymGetLineFromAddr = NULL;
extern void *ptr_SymGetLineFromAddr64;
void *ptr_SymGetLineFromAddr64 = NULL;
extern void *ptr_SymGetLineFromAddrW64;
void *ptr_SymGetLineFromAddrW64 = NULL;
extern void *ptr_SymGetLineFromName;
void *ptr_SymGetLineFromName = NULL;
extern void *ptr_SymGetLineFromName64;
void *ptr_SymGetLineFromName64 = NULL;
extern void *ptr_SymGetLineFromNameW64;
void *ptr_SymGetLineFromNameW64 = NULL;
extern void *ptr_SymGetLineNext;
void *ptr_SymGetLineNext = NULL;
extern void *ptr_SymGetLineNext64;
void *ptr_SymGetLineNext64 = NULL;
extern void *ptr_SymGetLineNextW64;
void *ptr_SymGetLineNextW64 = NULL;
extern void *ptr_SymGetLinePrev;
void *ptr_SymGetLinePrev = NULL;
extern void *ptr_SymGetLinePrev64;
void *ptr_SymGetLinePrev64 = NULL;
extern void *ptr_SymGetLinePrevW64;
void *ptr_SymGetLinePrevW64 = NULL;
extern void *ptr_SymGetModuleBase;
void *ptr_SymGetModuleBase = NULL;
extern void *ptr_SymGetModuleBase64;
void *ptr_SymGetModuleBase64 = NULL;
extern void *ptr_SymGetModuleInfo;
void *ptr_SymGetModuleInfo = NULL;
extern void *ptr_SymGetModuleInfo64;
void *ptr_SymGetModuleInfo64 = NULL;
extern void *ptr_SymGetModuleInfoW;
void *ptr_SymGetModuleInfoW = NULL;
extern void *ptr_SymGetModuleInfoW64;
void *ptr_SymGetModuleInfoW64 = NULL;
extern void *ptr_SymGetOmapBlockBase;
void *ptr_SymGetOmapBlockBase = NULL;
extern void *ptr_SymGetOmaps;
void *ptr_SymGetOmaps = NULL;
extern void *ptr_SymGetOptions;
void *ptr_SymGetOptions = NULL;
extern void *ptr_SymGetScope;
void *ptr_SymGetScope = NULL;
extern void *ptr_SymGetScopeW;
void *ptr_SymGetScopeW = NULL;
extern void *ptr_SymGetSearchPath;
void *ptr_SymGetSearchPath = NULL;
extern void *ptr_SymGetSearchPathW;
void *ptr_SymGetSearchPathW = NULL;
extern void *ptr_SymGetSourceFile;
void *ptr_SymGetSourceFile = NULL;
extern void *ptr_SymGetSourceFileFromToken;
void *ptr_SymGetSourceFileFromToken = NULL;
extern void *ptr_SymGetSourceFileFromTokenW;
void *ptr_SymGetSourceFileFromTokenW = NULL;
extern void *ptr_SymGetSourceFileToken;
void *ptr_SymGetSourceFileToken = NULL;
extern void *ptr_SymGetSourceFileTokenW;
void *ptr_SymGetSourceFileTokenW = NULL;
extern void *ptr_SymGetSourceFileW;
void *ptr_SymGetSourceFileW = NULL;
extern void *ptr_SymGetSourceVarFromToken;
void *ptr_SymGetSourceVarFromToken = NULL;
extern void *ptr_SymGetSourceVarFromTokenW;
void *ptr_SymGetSourceVarFromTokenW = NULL;
extern void *ptr_SymGetSymFromAddr;
void *ptr_SymGetSymFromAddr = NULL;
extern void *ptr_SymGetSymFromAddr64;
void *ptr_SymGetSymFromAddr64 = NULL;
extern void *ptr_SymGetSymFromName;
void *ptr_SymGetSymFromName = NULL;
extern void *ptr_SymGetSymFromName64;
void *ptr_SymGetSymFromName64 = NULL;
extern void *ptr_SymGetSymNext;
void *ptr_SymGetSymNext = NULL;
extern void *ptr_SymGetSymNext64;
void *ptr_SymGetSymNext64 = NULL;
extern void *ptr_SymGetSymPrev;
void *ptr_SymGetSymPrev = NULL;
extern void *ptr_SymGetSymPrev64;
void *ptr_SymGetSymPrev64 = NULL;
extern void *ptr_SymGetSymbolFile;
void *ptr_SymGetSymbolFile = NULL;
extern void *ptr_SymGetSymbolFileW;
void *ptr_SymGetSymbolFileW = NULL;
extern void *ptr_SymGetTypeFromName;
void *ptr_SymGetTypeFromName = NULL;
extern void *ptr_SymGetTypeFromNameW;
void *ptr_SymGetTypeFromNameW = NULL;
extern void *ptr_SymGetTypeInfo;
void *ptr_SymGetTypeInfo = NULL;
extern void *ptr_SymGetTypeInfoEx;
void *ptr_SymGetTypeInfoEx = NULL;
extern void *ptr_SymGetUnwindInfo;
void *ptr_SymGetUnwindInfo = NULL;
extern void *ptr_SymInitialize;
void *ptr_SymInitialize = NULL;
extern void *ptr_SymInitializeW;
void *ptr_SymInitializeW = NULL;
extern void *ptr_SymLoadModule;
void *ptr_SymLoadModule = NULL;
extern void *ptr_SymLoadModule64;
void *ptr_SymLoadModule64 = NULL;
extern void *ptr_SymLoadModuleEx;
void *ptr_SymLoadModuleEx = NULL;
extern void *ptr_SymLoadModuleExW;
void *ptr_SymLoadModuleExW = NULL;
extern void *ptr_SymMatchFileName;
void *ptr_SymMatchFileName = NULL;
extern void *ptr_SymMatchFileNameW;
void *ptr_SymMatchFileNameW = NULL;
extern void *ptr_SymMatchString;
void *ptr_SymMatchString = NULL;
extern void *ptr_SymMatchStringA;
void *ptr_SymMatchStringA = NULL;
extern void *ptr_SymMatchStringW;
void *ptr_SymMatchStringW = NULL;
extern void *ptr_SymNext;
void *ptr_SymNext = NULL;
extern void *ptr_SymNextW;
void *ptr_SymNextW = NULL;
extern void *ptr_SymPrev;
void *ptr_SymPrev = NULL;
extern void *ptr_SymPrevW;
void *ptr_SymPrevW = NULL;
extern void *ptr_SymRefreshModuleList;
void *ptr_SymRefreshModuleList = NULL;
extern void *ptr_SymRegisterCallback;
void *ptr_SymRegisterCallback = NULL;
extern void *ptr_SymRegisterCallback64;
void *ptr_SymRegisterCallback64 = NULL;
extern void *ptr_SymRegisterCallbackW64;
void *ptr_SymRegisterCallbackW64 = NULL;
extern void *ptr_SymRegisterFunctionEntryCallback;
void *ptr_SymRegisterFunctionEntryCallback = NULL;
extern void *ptr_SymRegisterFunctionEntryCallback64;
void *ptr_SymRegisterFunctionEntryCallback64 = NULL;
extern void *ptr_SymSearch;
void *ptr_SymSearch = NULL;
extern void *ptr_SymSearchW;
void *ptr_SymSearchW = NULL;
extern void *ptr_SymSetContext;
void *ptr_SymSetContext = NULL;
extern void *ptr_SymSetHomeDirectory;
void *ptr_SymSetHomeDirectory = NULL;
extern void *ptr_SymSetHomeDirectoryW;
void *ptr_SymSetHomeDirectoryW = NULL;
extern void *ptr_SymSetOptions;
void *ptr_SymSetOptions = NULL;
extern void *ptr_SymSetParentWindow;
void *ptr_SymSetParentWindow = NULL;
extern void *ptr_SymSetScopeFromAddr;
void *ptr_SymSetScopeFromAddr = NULL;
extern void *ptr_SymSetScopeFromIndex;
void *ptr_SymSetScopeFromIndex = NULL;
extern void *ptr_SymSetSearchPath;
void *ptr_SymSetSearchPath = NULL;
extern void *ptr_SymSetSearchPathW;
void *ptr_SymSetSearchPathW = NULL;
extern void *ptr_SymSrvDeltaName;
void *ptr_SymSrvDeltaName = NULL;
extern void *ptr_SymSrvDeltaNameW;
void *ptr_SymSrvDeltaNameW = NULL;
extern void *ptr_SymSrvGetFileIndexInfo;
void *ptr_SymSrvGetFileIndexInfo = NULL;
extern void *ptr_SymSrvGetFileIndexInfoW;
void *ptr_SymSrvGetFileIndexInfoW = NULL;
extern void *ptr_SymSrvGetFileIndexString;
void *ptr_SymSrvGetFileIndexString = NULL;
extern void *ptr_SymSrvGetFileIndexStringW;
void *ptr_SymSrvGetFileIndexStringW = NULL;
extern void *ptr_SymSrvGetFileIndexes;
void *ptr_SymSrvGetFileIndexes = NULL;
extern void *ptr_SymSrvGetFileIndexesW;
void *ptr_SymSrvGetFileIndexesW = NULL;
extern void *ptr_SymSrvGetSupplement;
void *ptr_SymSrvGetSupplement = NULL;
extern void *ptr_SymSrvGetSupplementW;
void *ptr_SymSrvGetSupplementW = NULL;
extern void *ptr_SymSrvIsStore;
void *ptr_SymSrvIsStore = NULL;
extern void *ptr_SymSrvIsStoreW;
void *ptr_SymSrvIsStoreW = NULL;
extern void *ptr_SymSrvStoreFile;
void *ptr_SymSrvStoreFile = NULL;
extern void *ptr_SymSrvStoreFileW;
void *ptr_SymSrvStoreFileW = NULL;
extern void *ptr_SymSrvStoreSupplement;
void *ptr_SymSrvStoreSupplement = NULL;
extern void *ptr_SymSrvStoreSupplementW;
void *ptr_SymSrvStoreSupplementW = NULL;
extern void *ptr_SymUnDName;
void *ptr_SymUnDName = NULL;
extern void *ptr_SymUnDName64;
void *ptr_SymUnDName64 = NULL;
extern void *ptr_SymUnloadModule;
void *ptr_SymUnloadModule = NULL;
extern void *ptr_SymUnloadModule64;
void *ptr_SymUnloadModule64 = NULL;
extern void *ptr_UnDecorateSymbolName;
void *ptr_UnDecorateSymbolName = NULL;
extern void *ptr_UnDecorateSymbolNameW;
void *ptr_UnDecorateSymbolNameW = NULL;
extern void *ptr_WinDbgExtensionDllInit;
void *ptr_WinDbgExtensionDllInit = NULL;
extern void *ptr_block;
void *ptr_block = NULL;
extern void *ptr_chksym;
void *ptr_chksym = NULL;
extern void *ptr_dbghelp;
void *ptr_dbghelp = NULL;
extern void *ptr_dh;
void *ptr_dh = NULL;
extern void *ptr_fptr;
void *ptr_fptr = NULL;
extern void *ptr_homedir;
void *ptr_homedir = NULL;
extern void *ptr_itoldyouso;
void *ptr_itoldyouso = NULL;
extern void *ptr_lmi;
void *ptr_lmi = NULL;
extern void *ptr_lminfo;
void *ptr_lminfo = NULL;
extern void *ptr_omap;
void *ptr_omap = NULL;
extern void *ptr_srcfiles;
void *ptr_srcfiles = NULL;
extern void *ptr_stack_force_ebp;
void *ptr_stack_force_ebp = NULL;
extern void *ptr_stackdbg;
void *ptr_stackdbg = NULL;
extern void *ptr_sym;
void *ptr_sym = NULL;
extern void *ptr_symsrv;
void *ptr_symsrv = NULL;
extern void *ptr_vc7fpo;
void *ptr_vc7fpo = NULL;
}


static HMODULE hModule = NULL;
static void module_init()
{    
   if (hModule) return;
   wchar_t sz_module_file[MAX_PATH];
   GetSystemDirectoryW(sz_module_file, MAX_PATH);
   wcscat_s(sz_module_file, L"\\dbghelp.dll");
   hModule = LoadLibraryW(sz_module_file);
   if (!hModule) return;

   #define __vartype(x) decltype(x)
   ptr_DbgHelpCreateUserDump = (__vartype(ptr_DbgHelpCreateUserDump))GetProcAddress(hModule, "DbgHelpCreateUserDump");
   ptr_DbgHelpCreateUserDumpW = (__vartype(ptr_DbgHelpCreateUserDumpW))GetProcAddress(hModule, "DbgHelpCreateUserDumpW");
   ptr_EnumDirTree = (__vartype(ptr_EnumDirTree))GetProcAddress(hModule, "EnumDirTree");
   ptr_EnumDirTreeW = (__vartype(ptr_EnumDirTreeW))GetProcAddress(hModule, "EnumDirTreeW");
   ptr_EnumerateLoadedModules = (__vartype(ptr_EnumerateLoadedModules))GetProcAddress(hModule, "EnumerateLoadedModules");
   ptr_EnumerateLoadedModules64 = (__vartype(ptr_EnumerateLoadedModules64))GetProcAddress(hModule, "EnumerateLoadedModules64");
   ptr_EnumerateLoadedModulesEx = (__vartype(ptr_EnumerateLoadedModulesEx))GetProcAddress(hModule, "EnumerateLoadedModulesEx");
   ptr_EnumerateLoadedModulesExW = (__vartype(ptr_EnumerateLoadedModulesExW))GetProcAddress(hModule, "EnumerateLoadedModulesExW");
   ptr_EnumerateLoadedModulesW64 = (__vartype(ptr_EnumerateLoadedModulesW64))GetProcAddress(hModule, "EnumerateLoadedModulesW64");
   ptr_ExtensionApiVersion = (__vartype(ptr_ExtensionApiVersion))GetProcAddress(hModule, "ExtensionApiVersion");
   ptr_FindDebugInfoFile = (__vartype(ptr_FindDebugInfoFile))GetProcAddress(hModule, "FindDebugInfoFile");
   ptr_FindDebugInfoFileEx = (__vartype(ptr_FindDebugInfoFileEx))GetProcAddress(hModule, "FindDebugInfoFileEx");
   ptr_FindDebugInfoFileExW = (__vartype(ptr_FindDebugInfoFileExW))GetProcAddress(hModule, "FindDebugInfoFileExW");
   ptr_FindExecutableImage = (__vartype(ptr_FindExecutableImage))GetProcAddress(hModule, "FindExecutableImage");
   ptr_FindExecutableImageEx = (__vartype(ptr_FindExecutableImageEx))GetProcAddress(hModule, "FindExecutableImageEx");
   ptr_FindExecutableImageExW = (__vartype(ptr_FindExecutableImageExW))GetProcAddress(hModule, "FindExecutableImageExW");
   ptr_FindFileInPath = (__vartype(ptr_FindFileInPath))GetProcAddress(hModule, "FindFileInPath");
   ptr_FindFileInSearchPath = (__vartype(ptr_FindFileInSearchPath))GetProcAddress(hModule, "FindFileInSearchPath");
   ptr_GetTimestampForLoadedLibrary = (__vartype(ptr_GetTimestampForLoadedLibrary))GetProcAddress(hModule, "GetTimestampForLoadedLibrary");
   ptr_ImageDirectoryEntryToData = (__vartype(ptr_ImageDirectoryEntryToData))GetProcAddress(hModule, "ImageDirectoryEntryToData");
   ptr_ImageDirectoryEntryToDataEx = (__vartype(ptr_ImageDirectoryEntryToDataEx))GetProcAddress(hModule, "ImageDirectoryEntryToDataEx");
   ptr_ImageNtHeader = (__vartype(ptr_ImageNtHeader))GetProcAddress(hModule, "ImageNtHeader");
   ptr_ImageRvaToSection = (__vartype(ptr_ImageRvaToSection))GetProcAddress(hModule, "ImageRvaToSection");
   ptr_ImageRvaToVa = (__vartype(ptr_ImageRvaToVa))GetProcAddress(hModule, "ImageRvaToVa");
   ptr_ImagehlpApiVersion = (__vartype(ptr_ImagehlpApiVersion))GetProcAddress(hModule, "ImagehlpApiVersion");
   ptr_ImagehlpApiVersionEx = (__vartype(ptr_ImagehlpApiVersionEx))GetProcAddress(hModule, "ImagehlpApiVersionEx");
   ptr_MakeSureDirectoryPathExists = (__vartype(ptr_MakeSureDirectoryPathExists))GetProcAddress(hModule, "MakeSureDirectoryPathExists");
   ptr_MiniDumpReadDumpStream = (__vartype(ptr_MiniDumpReadDumpStream))GetProcAddress(hModule, "MiniDumpReadDumpStream");
   ptr_MiniDumpWriteDump = (__vartype(ptr_MiniDumpWriteDump))GetProcAddress(hModule, "MiniDumpWriteDump");
   ptr_SearchTreeForFile = (__vartype(ptr_SearchTreeForFile))GetProcAddress(hModule, "SearchTreeForFile");
   ptr_SearchTreeForFileW = (__vartype(ptr_SearchTreeForFileW))GetProcAddress(hModule, "SearchTreeForFileW");
   ptr_StackWalk = (__vartype(ptr_StackWalk))GetProcAddress(hModule, "StackWalk");
   ptr_StackWalk64 = (__vartype(ptr_StackWalk64))GetProcAddress(hModule, "StackWalk64");
   ptr_SymAddSourceStream = (__vartype(ptr_SymAddSourceStream))GetProcAddress(hModule, "SymAddSourceStream");
   ptr_SymAddSourceStreamA = (__vartype(ptr_SymAddSourceStreamA))GetProcAddress(hModule, "SymAddSourceStreamA");
   ptr_SymAddSourceStreamW = (__vartype(ptr_SymAddSourceStreamW))GetProcAddress(hModule, "SymAddSourceStreamW");
   ptr_SymAddSymbol = (__vartype(ptr_SymAddSymbol))GetProcAddress(hModule, "SymAddSymbol");
   ptr_SymAddSymbolW = (__vartype(ptr_SymAddSymbolW))GetProcAddress(hModule, "SymAddSymbolW");
   ptr_SymCleanup = (__vartype(ptr_SymCleanup))GetProcAddress(hModule, "SymCleanup");
   ptr_SymDeleteSymbol = (__vartype(ptr_SymDeleteSymbol))GetProcAddress(hModule, "SymDeleteSymbol");
   ptr_SymDeleteSymbolW = (__vartype(ptr_SymDeleteSymbolW))GetProcAddress(hModule, "SymDeleteSymbolW");
   ptr_SymEnumLines = (__vartype(ptr_SymEnumLines))GetProcAddress(hModule, "SymEnumLines");
   ptr_SymEnumLinesW = (__vartype(ptr_SymEnumLinesW))GetProcAddress(hModule, "SymEnumLinesW");
   ptr_SymEnumProcesses = (__vartype(ptr_SymEnumProcesses))GetProcAddress(hModule, "SymEnumProcesses");
   ptr_SymEnumSourceFileTokens = (__vartype(ptr_SymEnumSourceFileTokens))GetProcAddress(hModule, "SymEnumSourceFileTokens");
   ptr_SymEnumSourceFiles = (__vartype(ptr_SymEnumSourceFiles))GetProcAddress(hModule, "SymEnumSourceFiles");
   ptr_SymEnumSourceFilesW = (__vartype(ptr_SymEnumSourceFilesW))GetProcAddress(hModule, "SymEnumSourceFilesW");
   ptr_SymEnumSourceLines = (__vartype(ptr_SymEnumSourceLines))GetProcAddress(hModule, "SymEnumSourceLines");
   ptr_SymEnumSourceLinesW = (__vartype(ptr_SymEnumSourceLinesW))GetProcAddress(hModule, "SymEnumSourceLinesW");
   ptr_SymEnumSym = (__vartype(ptr_SymEnumSym))GetProcAddress(hModule, "SymEnumSym");
   ptr_SymEnumSymbols = (__vartype(ptr_SymEnumSymbols))GetProcAddress(hModule, "SymEnumSymbols");
   ptr_SymEnumSymbolsForAddr = (__vartype(ptr_SymEnumSymbolsForAddr))GetProcAddress(hModule, "SymEnumSymbolsForAddr");
   ptr_SymEnumSymbolsForAddrW = (__vartype(ptr_SymEnumSymbolsForAddrW))GetProcAddress(hModule, "SymEnumSymbolsForAddrW");
   ptr_SymEnumSymbolsW = (__vartype(ptr_SymEnumSymbolsW))GetProcAddress(hModule, "SymEnumSymbolsW");
   ptr_SymEnumTypes = (__vartype(ptr_SymEnumTypes))GetProcAddress(hModule, "SymEnumTypes");
   ptr_SymEnumTypesByName = (__vartype(ptr_SymEnumTypesByName))GetProcAddress(hModule, "SymEnumTypesByName");
   ptr_SymEnumTypesByNameW = (__vartype(ptr_SymEnumTypesByNameW))GetProcAddress(hModule, "SymEnumTypesByNameW");
   ptr_SymEnumTypesW = (__vartype(ptr_SymEnumTypesW))GetProcAddress(hModule, "SymEnumTypesW");
   ptr_SymEnumerateModules = (__vartype(ptr_SymEnumerateModules))GetProcAddress(hModule, "SymEnumerateModules");
   ptr_SymEnumerateModules64 = (__vartype(ptr_SymEnumerateModules64))GetProcAddress(hModule, "SymEnumerateModules64");
   ptr_SymEnumerateModulesW64 = (__vartype(ptr_SymEnumerateModulesW64))GetProcAddress(hModule, "SymEnumerateModulesW64");
   ptr_SymEnumerateSymbols = (__vartype(ptr_SymEnumerateSymbols))GetProcAddress(hModule, "SymEnumerateSymbols");
   ptr_SymEnumerateSymbols64 = (__vartype(ptr_SymEnumerateSymbols64))GetProcAddress(hModule, "SymEnumerateSymbols64");
   ptr_SymEnumerateSymbolsW = (__vartype(ptr_SymEnumerateSymbolsW))GetProcAddress(hModule, "SymEnumerateSymbolsW");
   ptr_SymEnumerateSymbolsW64 = (__vartype(ptr_SymEnumerateSymbolsW64))GetProcAddress(hModule, "SymEnumerateSymbolsW64");
   ptr_SymFindDebugInfoFile = (__vartype(ptr_SymFindDebugInfoFile))GetProcAddress(hModule, "SymFindDebugInfoFile");
   ptr_SymFindDebugInfoFileW = (__vartype(ptr_SymFindDebugInfoFileW))GetProcAddress(hModule, "SymFindDebugInfoFileW");
   ptr_SymFindExecutableImage = (__vartype(ptr_SymFindExecutableImage))GetProcAddress(hModule, "SymFindExecutableImage");
   ptr_SymFindExecutableImageW = (__vartype(ptr_SymFindExecutableImageW))GetProcAddress(hModule, "SymFindExecutableImageW");
   ptr_SymFindFileInPath = (__vartype(ptr_SymFindFileInPath))GetProcAddress(hModule, "SymFindFileInPath");
   ptr_SymFindFileInPathW = (__vartype(ptr_SymFindFileInPathW))GetProcAddress(hModule, "SymFindFileInPathW");
   ptr_SymFromAddr = (__vartype(ptr_SymFromAddr))GetProcAddress(hModule, "SymFromAddr");
   ptr_SymFromAddrW = (__vartype(ptr_SymFromAddrW))GetProcAddress(hModule, "SymFromAddrW");
   ptr_SymFromIndex = (__vartype(ptr_SymFromIndex))GetProcAddress(hModule, "SymFromIndex");
   ptr_SymFromIndexW = (__vartype(ptr_SymFromIndexW))GetProcAddress(hModule, "SymFromIndexW");
   ptr_SymFromName = (__vartype(ptr_SymFromName))GetProcAddress(hModule, "SymFromName");
   ptr_SymFromNameW = (__vartype(ptr_SymFromNameW))GetProcAddress(hModule, "SymFromNameW");
   ptr_SymFromToken = (__vartype(ptr_SymFromToken))GetProcAddress(hModule, "SymFromToken");
   ptr_SymFromTokenW = (__vartype(ptr_SymFromTokenW))GetProcAddress(hModule, "SymFromTokenW");
   ptr_SymFunctionTableAccess = (__vartype(ptr_SymFunctionTableAccess))GetProcAddress(hModule, "SymFunctionTableAccess");
   ptr_SymFunctionTableAccess64 = (__vartype(ptr_SymFunctionTableAccess64))GetProcAddress(hModule, "SymFunctionTableAccess64");
   ptr_SymGetFileLineOffsets64 = (__vartype(ptr_SymGetFileLineOffsets64))GetProcAddress(hModule, "SymGetFileLineOffsets64");
   ptr_SymGetHomeDirectory = (__vartype(ptr_SymGetHomeDirectory))GetProcAddress(hModule, "SymGetHomeDirectory");
   ptr_SymGetHomeDirectoryW = (__vartype(ptr_SymGetHomeDirectoryW))GetProcAddress(hModule, "SymGetHomeDirectoryW");
   ptr_SymGetLineFromAddr = (__vartype(ptr_SymGetLineFromAddr))GetProcAddress(hModule, "SymGetLineFromAddr");
   ptr_SymGetLineFromAddr64 = (__vartype(ptr_SymGetLineFromAddr64))GetProcAddress(hModule, "SymGetLineFromAddr64");
   ptr_SymGetLineFromAddrW64 = (__vartype(ptr_SymGetLineFromAddrW64))GetProcAddress(hModule, "SymGetLineFromAddrW64");
   ptr_SymGetLineFromName = (__vartype(ptr_SymGetLineFromName))GetProcAddress(hModule, "SymGetLineFromName");
   ptr_SymGetLineFromName64 = (__vartype(ptr_SymGetLineFromName64))GetProcAddress(hModule, "SymGetLineFromName64");
   ptr_SymGetLineFromNameW64 = (__vartype(ptr_SymGetLineFromNameW64))GetProcAddress(hModule, "SymGetLineFromNameW64");
   ptr_SymGetLineNext = (__vartype(ptr_SymGetLineNext))GetProcAddress(hModule, "SymGetLineNext");
   ptr_SymGetLineNext64 = (__vartype(ptr_SymGetLineNext64))GetProcAddress(hModule, "SymGetLineNext64");
   ptr_SymGetLineNextW64 = (__vartype(ptr_SymGetLineNextW64))GetProcAddress(hModule, "SymGetLineNextW64");
   ptr_SymGetLinePrev = (__vartype(ptr_SymGetLinePrev))GetProcAddress(hModule, "SymGetLinePrev");
   ptr_SymGetLinePrev64 = (__vartype(ptr_SymGetLinePrev64))GetProcAddress(hModule, "SymGetLinePrev64");
   ptr_SymGetLinePrevW64 = (__vartype(ptr_SymGetLinePrevW64))GetProcAddress(hModule, "SymGetLinePrevW64");
   ptr_SymGetModuleBase = (__vartype(ptr_SymGetModuleBase))GetProcAddress(hModule, "SymGetModuleBase");
   ptr_SymGetModuleBase64 = (__vartype(ptr_SymGetModuleBase64))GetProcAddress(hModule, "SymGetModuleBase64");
   ptr_SymGetModuleInfo = (__vartype(ptr_SymGetModuleInfo))GetProcAddress(hModule, "SymGetModuleInfo");
   ptr_SymGetModuleInfo64 = (__vartype(ptr_SymGetModuleInfo64))GetProcAddress(hModule, "SymGetModuleInfo64");
   ptr_SymGetModuleInfoW = (__vartype(ptr_SymGetModuleInfoW))GetProcAddress(hModule, "SymGetModuleInfoW");
   ptr_SymGetModuleInfoW64 = (__vartype(ptr_SymGetModuleInfoW64))GetProcAddress(hModule, "SymGetModuleInfoW64");
   ptr_SymGetOmapBlockBase = (__vartype(ptr_SymGetOmapBlockBase))GetProcAddress(hModule, "SymGetOmapBlockBase");
   ptr_SymGetOmaps = (__vartype(ptr_SymGetOmaps))GetProcAddress(hModule, "SymGetOmaps");
   ptr_SymGetOptions = (__vartype(ptr_SymGetOptions))GetProcAddress(hModule, "SymGetOptions");
   ptr_SymGetScope = (__vartype(ptr_SymGetScope))GetProcAddress(hModule, "SymGetScope");
   ptr_SymGetScopeW = (__vartype(ptr_SymGetScopeW))GetProcAddress(hModule, "SymGetScopeW");
   ptr_SymGetSearchPath = (__vartype(ptr_SymGetSearchPath))GetProcAddress(hModule, "SymGetSearchPath");
   ptr_SymGetSearchPathW = (__vartype(ptr_SymGetSearchPathW))GetProcAddress(hModule, "SymGetSearchPathW");
   ptr_SymGetSourceFile = (__vartype(ptr_SymGetSourceFile))GetProcAddress(hModule, "SymGetSourceFile");
   ptr_SymGetSourceFileFromToken = (__vartype(ptr_SymGetSourceFileFromToken))GetProcAddress(hModule, "SymGetSourceFileFromToken");
   ptr_SymGetSourceFileFromTokenW = (__vartype(ptr_SymGetSourceFileFromTokenW))GetProcAddress(hModule, "SymGetSourceFileFromTokenW");
   ptr_SymGetSourceFileToken = (__vartype(ptr_SymGetSourceFileToken))GetProcAddress(hModule, "SymGetSourceFileToken");
   ptr_SymGetSourceFileTokenW = (__vartype(ptr_SymGetSourceFileTokenW))GetProcAddress(hModule, "SymGetSourceFileTokenW");
   ptr_SymGetSourceFileW = (__vartype(ptr_SymGetSourceFileW))GetProcAddress(hModule, "SymGetSourceFileW");
   ptr_SymGetSourceVarFromToken = (__vartype(ptr_SymGetSourceVarFromToken))GetProcAddress(hModule, "SymGetSourceVarFromToken");
   ptr_SymGetSourceVarFromTokenW = (__vartype(ptr_SymGetSourceVarFromTokenW))GetProcAddress(hModule, "SymGetSourceVarFromTokenW");
   ptr_SymGetSymFromAddr = (__vartype(ptr_SymGetSymFromAddr))GetProcAddress(hModule, "SymGetSymFromAddr");
   ptr_SymGetSymFromAddr64 = (__vartype(ptr_SymGetSymFromAddr64))GetProcAddress(hModule, "SymGetSymFromAddr64");
   ptr_SymGetSymFromName = (__vartype(ptr_SymGetSymFromName))GetProcAddress(hModule, "SymGetSymFromName");
   ptr_SymGetSymFromName64 = (__vartype(ptr_SymGetSymFromName64))GetProcAddress(hModule, "SymGetSymFromName64");
   ptr_SymGetSymNext = (__vartype(ptr_SymGetSymNext))GetProcAddress(hModule, "SymGetSymNext");
   ptr_SymGetSymNext64 = (__vartype(ptr_SymGetSymNext64))GetProcAddress(hModule, "SymGetSymNext64");
   ptr_SymGetSymPrev = (__vartype(ptr_SymGetSymPrev))GetProcAddress(hModule, "SymGetSymPrev");
   ptr_SymGetSymPrev64 = (__vartype(ptr_SymGetSymPrev64))GetProcAddress(hModule, "SymGetSymPrev64");
   ptr_SymGetSymbolFile = (__vartype(ptr_SymGetSymbolFile))GetProcAddress(hModule, "SymGetSymbolFile");
   ptr_SymGetSymbolFileW = (__vartype(ptr_SymGetSymbolFileW))GetProcAddress(hModule, "SymGetSymbolFileW");
   ptr_SymGetTypeFromName = (__vartype(ptr_SymGetTypeFromName))GetProcAddress(hModule, "SymGetTypeFromName");
   ptr_SymGetTypeFromNameW = (__vartype(ptr_SymGetTypeFromNameW))GetProcAddress(hModule, "SymGetTypeFromNameW");
   ptr_SymGetTypeInfo = (__vartype(ptr_SymGetTypeInfo))GetProcAddress(hModule, "SymGetTypeInfo");
   ptr_SymGetTypeInfoEx = (__vartype(ptr_SymGetTypeInfoEx))GetProcAddress(hModule, "SymGetTypeInfoEx");
   ptr_SymGetUnwindInfo = (__vartype(ptr_SymGetUnwindInfo))GetProcAddress(hModule, "SymGetUnwindInfo");
   ptr_SymInitialize = (__vartype(ptr_SymInitialize))GetProcAddress(hModule, "SymInitialize");
   ptr_SymInitializeW = (__vartype(ptr_SymInitializeW))GetProcAddress(hModule, "SymInitializeW");
   ptr_SymLoadModule = (__vartype(ptr_SymLoadModule))GetProcAddress(hModule, "SymLoadModule");
   ptr_SymLoadModule64 = (__vartype(ptr_SymLoadModule64))GetProcAddress(hModule, "SymLoadModule64");
   ptr_SymLoadModuleEx = (__vartype(ptr_SymLoadModuleEx))GetProcAddress(hModule, "SymLoadModuleEx");
   ptr_SymLoadModuleExW = (__vartype(ptr_SymLoadModuleExW))GetProcAddress(hModule, "SymLoadModuleExW");
   ptr_SymMatchFileName = (__vartype(ptr_SymMatchFileName))GetProcAddress(hModule, "SymMatchFileName");
   ptr_SymMatchFileNameW = (__vartype(ptr_SymMatchFileNameW))GetProcAddress(hModule, "SymMatchFileNameW");
   ptr_SymMatchString = (__vartype(ptr_SymMatchString))GetProcAddress(hModule, "SymMatchString");
   ptr_SymMatchStringA = (__vartype(ptr_SymMatchStringA))GetProcAddress(hModule, "SymMatchStringA");
   ptr_SymMatchStringW = (__vartype(ptr_SymMatchStringW))GetProcAddress(hModule, "SymMatchStringW");
   ptr_SymNext = (__vartype(ptr_SymNext))GetProcAddress(hModule, "SymNext");
   ptr_SymNextW = (__vartype(ptr_SymNextW))GetProcAddress(hModule, "SymNextW");
   ptr_SymPrev = (__vartype(ptr_SymPrev))GetProcAddress(hModule, "SymPrev");
   ptr_SymPrevW = (__vartype(ptr_SymPrevW))GetProcAddress(hModule, "SymPrevW");
   ptr_SymRefreshModuleList = (__vartype(ptr_SymRefreshModuleList))GetProcAddress(hModule, "SymRefreshModuleList");
   ptr_SymRegisterCallback = (__vartype(ptr_SymRegisterCallback))GetProcAddress(hModule, "SymRegisterCallback");
   ptr_SymRegisterCallback64 = (__vartype(ptr_SymRegisterCallback64))GetProcAddress(hModule, "SymRegisterCallback64");
   ptr_SymRegisterCallbackW64 = (__vartype(ptr_SymRegisterCallbackW64))GetProcAddress(hModule, "SymRegisterCallbackW64");
   ptr_SymRegisterFunctionEntryCallback = (__vartype(ptr_SymRegisterFunctionEntryCallback))GetProcAddress(hModule, "SymRegisterFunctionEntryCallback");
   ptr_SymRegisterFunctionEntryCallback64 = (__vartype(ptr_SymRegisterFunctionEntryCallback64))GetProcAddress(hModule, "SymRegisterFunctionEntryCallback64");
   ptr_SymSearch = (__vartype(ptr_SymSearch))GetProcAddress(hModule, "SymSearch");
   ptr_SymSearchW = (__vartype(ptr_SymSearchW))GetProcAddress(hModule, "SymSearchW");
   ptr_SymSetContext = (__vartype(ptr_SymSetContext))GetProcAddress(hModule, "SymSetContext");
   ptr_SymSetHomeDirectory = (__vartype(ptr_SymSetHomeDirectory))GetProcAddress(hModule, "SymSetHomeDirectory");
   ptr_SymSetHomeDirectoryW = (__vartype(ptr_SymSetHomeDirectoryW))GetProcAddress(hModule, "SymSetHomeDirectoryW");
   ptr_SymSetOptions = (__vartype(ptr_SymSetOptions))GetProcAddress(hModule, "SymSetOptions");
   ptr_SymSetParentWindow = (__vartype(ptr_SymSetParentWindow))GetProcAddress(hModule, "SymSetParentWindow");
   ptr_SymSetScopeFromAddr = (__vartype(ptr_SymSetScopeFromAddr))GetProcAddress(hModule, "SymSetScopeFromAddr");
   ptr_SymSetScopeFromIndex = (__vartype(ptr_SymSetScopeFromIndex))GetProcAddress(hModule, "SymSetScopeFromIndex");
   ptr_SymSetSearchPath = (__vartype(ptr_SymSetSearchPath))GetProcAddress(hModule, "SymSetSearchPath");
   ptr_SymSetSearchPathW = (__vartype(ptr_SymSetSearchPathW))GetProcAddress(hModule, "SymSetSearchPathW");
   ptr_SymSrvDeltaName = (__vartype(ptr_SymSrvDeltaName))GetProcAddress(hModule, "SymSrvDeltaName");
   ptr_SymSrvDeltaNameW = (__vartype(ptr_SymSrvDeltaNameW))GetProcAddress(hModule, "SymSrvDeltaNameW");
   ptr_SymSrvGetFileIndexInfo = (__vartype(ptr_SymSrvGetFileIndexInfo))GetProcAddress(hModule, "SymSrvGetFileIndexInfo");
   ptr_SymSrvGetFileIndexInfoW = (__vartype(ptr_SymSrvGetFileIndexInfoW))GetProcAddress(hModule, "SymSrvGetFileIndexInfoW");
   ptr_SymSrvGetFileIndexString = (__vartype(ptr_SymSrvGetFileIndexString))GetProcAddress(hModule, "SymSrvGetFileIndexString");
   ptr_SymSrvGetFileIndexStringW = (__vartype(ptr_SymSrvGetFileIndexStringW))GetProcAddress(hModule, "SymSrvGetFileIndexStringW");
   ptr_SymSrvGetFileIndexes = (__vartype(ptr_SymSrvGetFileIndexes))GetProcAddress(hModule, "SymSrvGetFileIndexes");
   ptr_SymSrvGetFileIndexesW = (__vartype(ptr_SymSrvGetFileIndexesW))GetProcAddress(hModule, "SymSrvGetFileIndexesW");
   ptr_SymSrvGetSupplement = (__vartype(ptr_SymSrvGetSupplement))GetProcAddress(hModule, "SymSrvGetSupplement");
   ptr_SymSrvGetSupplementW = (__vartype(ptr_SymSrvGetSupplementW))GetProcAddress(hModule, "SymSrvGetSupplementW");
   ptr_SymSrvIsStore = (__vartype(ptr_SymSrvIsStore))GetProcAddress(hModule, "SymSrvIsStore");
   ptr_SymSrvIsStoreW = (__vartype(ptr_SymSrvIsStoreW))GetProcAddress(hModule, "SymSrvIsStoreW");
   ptr_SymSrvStoreFile = (__vartype(ptr_SymSrvStoreFile))GetProcAddress(hModule, "SymSrvStoreFile");
   ptr_SymSrvStoreFileW = (__vartype(ptr_SymSrvStoreFileW))GetProcAddress(hModule, "SymSrvStoreFileW");
   ptr_SymSrvStoreSupplement = (__vartype(ptr_SymSrvStoreSupplement))GetProcAddress(hModule, "SymSrvStoreSupplement");
   ptr_SymSrvStoreSupplementW = (__vartype(ptr_SymSrvStoreSupplementW))GetProcAddress(hModule, "SymSrvStoreSupplementW");
   ptr_SymUnDName = (__vartype(ptr_SymUnDName))GetProcAddress(hModule, "SymUnDName");
   ptr_SymUnDName64 = (__vartype(ptr_SymUnDName64))GetProcAddress(hModule, "SymUnDName64");
   ptr_SymUnloadModule = (__vartype(ptr_SymUnloadModule))GetProcAddress(hModule, "SymUnloadModule");
   ptr_SymUnloadModule64 = (__vartype(ptr_SymUnloadModule64))GetProcAddress(hModule, "SymUnloadModule64");
   ptr_UnDecorateSymbolName = (__vartype(ptr_UnDecorateSymbolName))GetProcAddress(hModule, "UnDecorateSymbolName");
   ptr_UnDecorateSymbolNameW = (__vartype(ptr_UnDecorateSymbolNameW))GetProcAddress(hModule, "UnDecorateSymbolNameW");
   ptr_WinDbgExtensionDllInit = (__vartype(ptr_WinDbgExtensionDllInit))GetProcAddress(hModule, "WinDbgExtensionDllInit");
   ptr_block = (__vartype(ptr_block))GetProcAddress(hModule, "block");
   ptr_chksym = (__vartype(ptr_chksym))GetProcAddress(hModule, "chksym");
   ptr_dbghelp = (__vartype(ptr_dbghelp))GetProcAddress(hModule, "dbghelp");
   ptr_dh = (__vartype(ptr_dh))GetProcAddress(hModule, "dh");
   ptr_fptr = (__vartype(ptr_fptr))GetProcAddress(hModule, "fptr");
   ptr_homedir = (__vartype(ptr_homedir))GetProcAddress(hModule, "homedir");
   ptr_itoldyouso = (__vartype(ptr_itoldyouso))GetProcAddress(hModule, "itoldyouso");
   ptr_lmi = (__vartype(ptr_lmi))GetProcAddress(hModule, "lmi");
   ptr_lminfo = (__vartype(ptr_lminfo))GetProcAddress(hModule, "lminfo");
   ptr_omap = (__vartype(ptr_omap))GetProcAddress(hModule, "omap");
   ptr_srcfiles = (__vartype(ptr_srcfiles))GetProcAddress(hModule, "srcfiles");
   ptr_stack_force_ebp = (__vartype(ptr_stack_force_ebp))GetProcAddress(hModule, "stack_force_ebp");
   ptr_stackdbg = (__vartype(ptr_stackdbg))GetProcAddress(hModule, "stackdbg");
   ptr_sym = (__vartype(ptr_sym))GetProcAddress(hModule, "sym");
   ptr_symsrv = (__vartype(ptr_symsrv))GetProcAddress(hModule, "symsrv");
   ptr_vc7fpo = (__vartype(ptr_vc7fpo))GetProcAddress(hModule, "vc7fpo");
   #undef __vartype
}

extern "C" BOOL __stdcall DllMain( HMODULE hModule,	DWORD ul_reason_for_call,LPVOID lpReserved)
{
	switch (ul_reason_for_call)
	{
	case DLL_PROCESS_ATTACH:
    {
        module_init();
        wchar_t tmp1[2048];
        GetModuleFileNameW(NULL, tmp1, _countof(tmp1));
        PathRemoveExtensionW(tmp1);
        wcscat(tmp1, L".hook.dll");
        LoadLibraryW(tmp1);
        break;
    }
	case DLL_PROCESS_DETACH:
		break;
	}
	return TRUE;
}

