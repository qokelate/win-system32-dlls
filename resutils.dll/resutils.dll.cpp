#include <windows.h>
#include <shlwapi.h>

extern "C" {
extern void *ptr_ClusWorkerCheckTerminate;
void *ptr_ClusWorkerCheckTerminate = NULL;
extern void *ptr_ClusWorkerCreate;
void *ptr_ClusWorkerCreate = NULL;
extern void *ptr_ClusWorkerStart;
void *ptr_ClusWorkerStart = NULL;
extern void *ptr_ClusWorkerTerminate;
void *ptr_ClusWorkerTerminate = NULL;
extern void *ptr_ClusterClearBackupStateForSharedVolume;
void *ptr_ClusterClearBackupStateForSharedVolume = NULL;
extern void *ptr_ClusterGetVolumeNameForVolumeMountPoint;
void *ptr_ClusterGetVolumeNameForVolumeMountPoint = NULL;
extern void *ptr_ClusterGetVolumePathName;
void *ptr_ClusterGetVolumePathName = NULL;
extern void *ptr_ClusterIsPathOnSharedVolume;
void *ptr_ClusterIsPathOnSharedVolume = NULL;
extern void *ptr_ClusterPrepareSharedVolumeForBackup;
void *ptr_ClusterPrepareSharedVolumeForBackup = NULL;
extern void *ptr_ResUtilAddUnknownProperties;
void *ptr_ResUtilAddUnknownProperties = NULL;
extern void *ptr_ResUtilCreateDirectoryTree;
void *ptr_ResUtilCreateDirectoryTree = NULL;
extern void *ptr_ResUtilDupParameterBlock;
void *ptr_ResUtilDupParameterBlock = NULL;
extern void *ptr_ResUtilDupString;
void *ptr_ResUtilDupString = NULL;
extern void *ptr_ResUtilEnumPrivateProperties;
void *ptr_ResUtilEnumPrivateProperties = NULL;
extern void *ptr_ResUtilEnumProperties;
void *ptr_ResUtilEnumProperties = NULL;
extern void *ptr_ResUtilEnumResources;
void *ptr_ResUtilEnumResources = NULL;
extern void *ptr_ResUtilEnumResourcesEx;
void *ptr_ResUtilEnumResourcesEx = NULL;
extern void *ptr_ResUtilExpandEnvironmentStrings;
void *ptr_ResUtilExpandEnvironmentStrings = NULL;
extern void *ptr_ResUtilFindBinaryProperty;
void *ptr_ResUtilFindBinaryProperty = NULL;
extern void *ptr_ResUtilFindDependentDiskResourceDriveLetter;
void *ptr_ResUtilFindDependentDiskResourceDriveLetter = NULL;
extern void *ptr_ResUtilFindDwordProperty;
void *ptr_ResUtilFindDwordProperty = NULL;
extern void *ptr_ResUtilFindExpandSzProperty;
void *ptr_ResUtilFindExpandSzProperty = NULL;
extern void *ptr_ResUtilFindExpandedSzProperty;
void *ptr_ResUtilFindExpandedSzProperty = NULL;
extern void *ptr_ResUtilFindFileTimeProperty;
void *ptr_ResUtilFindFileTimeProperty = NULL;
extern void *ptr_ResUtilFindLongProperty;
void *ptr_ResUtilFindLongProperty = NULL;
extern void *ptr_ResUtilFindMultiSzProperty;
void *ptr_ResUtilFindMultiSzProperty = NULL;
extern void *ptr_ResUtilFindSzProperty;
void *ptr_ResUtilFindSzProperty = NULL;
extern void *ptr_ResUtilFreeEnvironment;
void *ptr_ResUtilFreeEnvironment = NULL;
extern void *ptr_ResUtilFreeParameterBlock;
void *ptr_ResUtilFreeParameterBlock = NULL;
extern void *ptr_ResUtilGetAllProperties;
void *ptr_ResUtilGetAllProperties = NULL;
extern void *ptr_ResUtilGetBinaryProperty;
void *ptr_ResUtilGetBinaryProperty = NULL;
extern void *ptr_ResUtilGetBinaryValue;
void *ptr_ResUtilGetBinaryValue = NULL;
extern void *ptr_ResUtilGetClusterRoleState;
void *ptr_ResUtilGetClusterRoleState = NULL;
extern void *ptr_ResUtilGetCoreClusterResources;
void *ptr_ResUtilGetCoreClusterResources = NULL;
extern void *ptr_ResUtilGetDwordProperty;
void *ptr_ResUtilGetDwordProperty = NULL;
extern void *ptr_ResUtilGetDwordValue;
void *ptr_ResUtilGetDwordValue = NULL;
extern void *ptr_ResUtilGetEnvironmentWithNetName;
void *ptr_ResUtilGetEnvironmentWithNetName = NULL;
extern void *ptr_ResUtilGetFileTimeProperty;
void *ptr_ResUtilGetFileTimeProperty = NULL;
extern void *ptr_ResUtilGetLongProperty;
void *ptr_ResUtilGetLongProperty = NULL;
extern void *ptr_ResUtilGetMultiSzProperty;
void *ptr_ResUtilGetMultiSzProperty = NULL;
extern void *ptr_ResUtilGetPrivateProperties;
void *ptr_ResUtilGetPrivateProperties = NULL;
extern void *ptr_ResUtilGetProperties;
void *ptr_ResUtilGetProperties = NULL;
extern void *ptr_ResUtilGetPropertiesToParameterBlock;
void *ptr_ResUtilGetPropertiesToParameterBlock = NULL;
extern void *ptr_ResUtilGetProperty;
void *ptr_ResUtilGetProperty = NULL;
extern void *ptr_ResUtilGetPropertyFormats;
void *ptr_ResUtilGetPropertyFormats = NULL;
extern void *ptr_ResUtilGetPropertySize;
void *ptr_ResUtilGetPropertySize = NULL;
extern void *ptr_ResUtilGetQwordValue;
void *ptr_ResUtilGetQwordValue = NULL;
extern void *ptr_ResUtilGetResourceDependency;
void *ptr_ResUtilGetResourceDependency = NULL;
extern void *ptr_ResUtilGetResourceDependencyByClass;
void *ptr_ResUtilGetResourceDependencyByClass = NULL;
extern void *ptr_ResUtilGetResourceDependencyByName;
void *ptr_ResUtilGetResourceDependencyByName = NULL;
extern void *ptr_ResUtilGetResourceDependentIPAddressProps;
void *ptr_ResUtilGetResourceDependentIPAddressProps = NULL;
extern void *ptr_ResUtilGetResourceName;
void *ptr_ResUtilGetResourceName = NULL;
extern void *ptr_ResUtilGetResourceNameDependency;
void *ptr_ResUtilGetResourceNameDependency = NULL;
extern void *ptr_ResUtilGetSzProperty;
void *ptr_ResUtilGetSzProperty = NULL;
extern void *ptr_ResUtilGetSzValue;
void *ptr_ResUtilGetSzValue = NULL;
extern void *ptr_ResUtilIsPathValid;
void *ptr_ResUtilIsPathValid = NULL;
extern void *ptr_ResUtilIsResourceClassEqual;
void *ptr_ResUtilIsResourceClassEqual = NULL;
extern void *ptr_ResUtilPropertyListFromParameterBlock;
void *ptr_ResUtilPropertyListFromParameterBlock = NULL;
extern void *ptr_ResUtilRemoveResourceServiceEnvironment;
void *ptr_ResUtilRemoveResourceServiceEnvironment = NULL;
extern void *ptr_ResUtilResourceTypesEqual;
void *ptr_ResUtilResourceTypesEqual = NULL;
extern void *ptr_ResUtilResourcesEqual;
void *ptr_ResUtilResourcesEqual = NULL;
extern void *ptr_ResUtilSetBinaryValue;
void *ptr_ResUtilSetBinaryValue = NULL;
extern void *ptr_ResUtilSetDwordValue;
void *ptr_ResUtilSetDwordValue = NULL;
extern void *ptr_ResUtilSetExpandSzValue;
void *ptr_ResUtilSetExpandSzValue = NULL;
extern void *ptr_ResUtilSetMultiSzValue;
void *ptr_ResUtilSetMultiSzValue = NULL;
extern void *ptr_ResUtilSetPrivatePropertyList;
void *ptr_ResUtilSetPrivatePropertyList = NULL;
extern void *ptr_ResUtilSetPropertyParameterBlock;
void *ptr_ResUtilSetPropertyParameterBlock = NULL;
extern void *ptr_ResUtilSetPropertyParameterBlockEx;
void *ptr_ResUtilSetPropertyParameterBlockEx = NULL;
extern void *ptr_ResUtilSetPropertyTable;
void *ptr_ResUtilSetPropertyTable = NULL;
extern void *ptr_ResUtilSetPropertyTableEx;
void *ptr_ResUtilSetPropertyTableEx = NULL;
extern void *ptr_ResUtilSetQwordValue;
void *ptr_ResUtilSetQwordValue = NULL;
extern void *ptr_ResUtilSetResourceServiceEnvironment;
void *ptr_ResUtilSetResourceServiceEnvironment = NULL;
extern void *ptr_ResUtilSetResourceServiceStartParameters;
void *ptr_ResUtilSetResourceServiceStartParameters = NULL;
extern void *ptr_ResUtilSetSzValue;
void *ptr_ResUtilSetSzValue = NULL;
extern void *ptr_ResUtilSetUnknownProperties;
void *ptr_ResUtilSetUnknownProperties = NULL;
extern void *ptr_ResUtilStartResourceService;
void *ptr_ResUtilStartResourceService = NULL;
extern void *ptr_ResUtilStopResourceService;
void *ptr_ResUtilStopResourceService = NULL;
extern void *ptr_ResUtilStopService;
void *ptr_ResUtilStopService = NULL;
extern void *ptr_ResUtilTerminateServiceProcessFromResDll;
void *ptr_ResUtilTerminateServiceProcessFromResDll = NULL;
extern void *ptr_ResUtilVerifyPrivatePropertyList;
void *ptr_ResUtilVerifyPrivatePropertyList = NULL;
extern void *ptr_ResUtilVerifyPropertyTable;
void *ptr_ResUtilVerifyPropertyTable = NULL;
extern void *ptr_ResUtilVerifyResourceService;
void *ptr_ResUtilVerifyResourceService = NULL;
extern void *ptr_ResUtilVerifyService;
void *ptr_ResUtilVerifyService = NULL;
}


static HMODULE hModule = NULL;
static void module_init()
{    
   if (hModule) return;
   wchar_t sz_module_file[MAX_PATH];
   GetSystemDirectoryW(sz_module_file, MAX_PATH);
   wcscat_s(sz_module_file, L"\\resutils.dll");
   hModule = LoadLibraryW(sz_module_file);
   if (!hModule) return;

   #define __vartype(x) decltype(x)
   ptr_ClusWorkerCheckTerminate = (__vartype(ptr_ClusWorkerCheckTerminate))GetProcAddress(hModule, "ClusWorkerCheckTerminate");
   ptr_ClusWorkerCreate = (__vartype(ptr_ClusWorkerCreate))GetProcAddress(hModule, "ClusWorkerCreate");
   ptr_ClusWorkerStart = (__vartype(ptr_ClusWorkerStart))GetProcAddress(hModule, "ClusWorkerStart");
   ptr_ClusWorkerTerminate = (__vartype(ptr_ClusWorkerTerminate))GetProcAddress(hModule, "ClusWorkerTerminate");
   ptr_ClusterClearBackupStateForSharedVolume = (__vartype(ptr_ClusterClearBackupStateForSharedVolume))GetProcAddress(hModule, "ClusterClearBackupStateForSharedVolume");
   ptr_ClusterGetVolumeNameForVolumeMountPoint = (__vartype(ptr_ClusterGetVolumeNameForVolumeMountPoint))GetProcAddress(hModule, "ClusterGetVolumeNameForVolumeMountPoint");
   ptr_ClusterGetVolumePathName = (__vartype(ptr_ClusterGetVolumePathName))GetProcAddress(hModule, "ClusterGetVolumePathName");
   ptr_ClusterIsPathOnSharedVolume = (__vartype(ptr_ClusterIsPathOnSharedVolume))GetProcAddress(hModule, "ClusterIsPathOnSharedVolume");
   ptr_ClusterPrepareSharedVolumeForBackup = (__vartype(ptr_ClusterPrepareSharedVolumeForBackup))GetProcAddress(hModule, "ClusterPrepareSharedVolumeForBackup");
   ptr_ResUtilAddUnknownProperties = (__vartype(ptr_ResUtilAddUnknownProperties))GetProcAddress(hModule, "ResUtilAddUnknownProperties");
   ptr_ResUtilCreateDirectoryTree = (__vartype(ptr_ResUtilCreateDirectoryTree))GetProcAddress(hModule, "ResUtilCreateDirectoryTree");
   ptr_ResUtilDupParameterBlock = (__vartype(ptr_ResUtilDupParameterBlock))GetProcAddress(hModule, "ResUtilDupParameterBlock");
   ptr_ResUtilDupString = (__vartype(ptr_ResUtilDupString))GetProcAddress(hModule, "ResUtilDupString");
   ptr_ResUtilEnumPrivateProperties = (__vartype(ptr_ResUtilEnumPrivateProperties))GetProcAddress(hModule, "ResUtilEnumPrivateProperties");
   ptr_ResUtilEnumProperties = (__vartype(ptr_ResUtilEnumProperties))GetProcAddress(hModule, "ResUtilEnumProperties");
   ptr_ResUtilEnumResources = (__vartype(ptr_ResUtilEnumResources))GetProcAddress(hModule, "ResUtilEnumResources");
   ptr_ResUtilEnumResourcesEx = (__vartype(ptr_ResUtilEnumResourcesEx))GetProcAddress(hModule, "ResUtilEnumResourcesEx");
   ptr_ResUtilExpandEnvironmentStrings = (__vartype(ptr_ResUtilExpandEnvironmentStrings))GetProcAddress(hModule, "ResUtilExpandEnvironmentStrings");
   ptr_ResUtilFindBinaryProperty = (__vartype(ptr_ResUtilFindBinaryProperty))GetProcAddress(hModule, "ResUtilFindBinaryProperty");
   ptr_ResUtilFindDependentDiskResourceDriveLetter = (__vartype(ptr_ResUtilFindDependentDiskResourceDriveLetter))GetProcAddress(hModule, "ResUtilFindDependentDiskResourceDriveLetter");
   ptr_ResUtilFindDwordProperty = (__vartype(ptr_ResUtilFindDwordProperty))GetProcAddress(hModule, "ResUtilFindDwordProperty");
   ptr_ResUtilFindExpandSzProperty = (__vartype(ptr_ResUtilFindExpandSzProperty))GetProcAddress(hModule, "ResUtilFindExpandSzProperty");
   ptr_ResUtilFindExpandedSzProperty = (__vartype(ptr_ResUtilFindExpandedSzProperty))GetProcAddress(hModule, "ResUtilFindExpandedSzProperty");
   ptr_ResUtilFindFileTimeProperty = (__vartype(ptr_ResUtilFindFileTimeProperty))GetProcAddress(hModule, "ResUtilFindFileTimeProperty");
   ptr_ResUtilFindLongProperty = (__vartype(ptr_ResUtilFindLongProperty))GetProcAddress(hModule, "ResUtilFindLongProperty");
   ptr_ResUtilFindMultiSzProperty = (__vartype(ptr_ResUtilFindMultiSzProperty))GetProcAddress(hModule, "ResUtilFindMultiSzProperty");
   ptr_ResUtilFindSzProperty = (__vartype(ptr_ResUtilFindSzProperty))GetProcAddress(hModule, "ResUtilFindSzProperty");
   ptr_ResUtilFreeEnvironment = (__vartype(ptr_ResUtilFreeEnvironment))GetProcAddress(hModule, "ResUtilFreeEnvironment");
   ptr_ResUtilFreeParameterBlock = (__vartype(ptr_ResUtilFreeParameterBlock))GetProcAddress(hModule, "ResUtilFreeParameterBlock");
   ptr_ResUtilGetAllProperties = (__vartype(ptr_ResUtilGetAllProperties))GetProcAddress(hModule, "ResUtilGetAllProperties");
   ptr_ResUtilGetBinaryProperty = (__vartype(ptr_ResUtilGetBinaryProperty))GetProcAddress(hModule, "ResUtilGetBinaryProperty");
   ptr_ResUtilGetBinaryValue = (__vartype(ptr_ResUtilGetBinaryValue))GetProcAddress(hModule, "ResUtilGetBinaryValue");
   ptr_ResUtilGetClusterRoleState = (__vartype(ptr_ResUtilGetClusterRoleState))GetProcAddress(hModule, "ResUtilGetClusterRoleState");
   ptr_ResUtilGetCoreClusterResources = (__vartype(ptr_ResUtilGetCoreClusterResources))GetProcAddress(hModule, "ResUtilGetCoreClusterResources");
   ptr_ResUtilGetDwordProperty = (__vartype(ptr_ResUtilGetDwordProperty))GetProcAddress(hModule, "ResUtilGetDwordProperty");
   ptr_ResUtilGetDwordValue = (__vartype(ptr_ResUtilGetDwordValue))GetProcAddress(hModule, "ResUtilGetDwordValue");
   ptr_ResUtilGetEnvironmentWithNetName = (__vartype(ptr_ResUtilGetEnvironmentWithNetName))GetProcAddress(hModule, "ResUtilGetEnvironmentWithNetName");
   ptr_ResUtilGetFileTimeProperty = (__vartype(ptr_ResUtilGetFileTimeProperty))GetProcAddress(hModule, "ResUtilGetFileTimeProperty");
   ptr_ResUtilGetLongProperty = (__vartype(ptr_ResUtilGetLongProperty))GetProcAddress(hModule, "ResUtilGetLongProperty");
   ptr_ResUtilGetMultiSzProperty = (__vartype(ptr_ResUtilGetMultiSzProperty))GetProcAddress(hModule, "ResUtilGetMultiSzProperty");
   ptr_ResUtilGetPrivateProperties = (__vartype(ptr_ResUtilGetPrivateProperties))GetProcAddress(hModule, "ResUtilGetPrivateProperties");
   ptr_ResUtilGetProperties = (__vartype(ptr_ResUtilGetProperties))GetProcAddress(hModule, "ResUtilGetProperties");
   ptr_ResUtilGetPropertiesToParameterBlock = (__vartype(ptr_ResUtilGetPropertiesToParameterBlock))GetProcAddress(hModule, "ResUtilGetPropertiesToParameterBlock");
   ptr_ResUtilGetProperty = (__vartype(ptr_ResUtilGetProperty))GetProcAddress(hModule, "ResUtilGetProperty");
   ptr_ResUtilGetPropertyFormats = (__vartype(ptr_ResUtilGetPropertyFormats))GetProcAddress(hModule, "ResUtilGetPropertyFormats");
   ptr_ResUtilGetPropertySize = (__vartype(ptr_ResUtilGetPropertySize))GetProcAddress(hModule, "ResUtilGetPropertySize");
   ptr_ResUtilGetQwordValue = (__vartype(ptr_ResUtilGetQwordValue))GetProcAddress(hModule, "ResUtilGetQwordValue");
   ptr_ResUtilGetResourceDependency = (__vartype(ptr_ResUtilGetResourceDependency))GetProcAddress(hModule, "ResUtilGetResourceDependency");
   ptr_ResUtilGetResourceDependencyByClass = (__vartype(ptr_ResUtilGetResourceDependencyByClass))GetProcAddress(hModule, "ResUtilGetResourceDependencyByClass");
   ptr_ResUtilGetResourceDependencyByName = (__vartype(ptr_ResUtilGetResourceDependencyByName))GetProcAddress(hModule, "ResUtilGetResourceDependencyByName");
   ptr_ResUtilGetResourceDependentIPAddressProps = (__vartype(ptr_ResUtilGetResourceDependentIPAddressProps))GetProcAddress(hModule, "ResUtilGetResourceDependentIPAddressProps");
   ptr_ResUtilGetResourceName = (__vartype(ptr_ResUtilGetResourceName))GetProcAddress(hModule, "ResUtilGetResourceName");
   ptr_ResUtilGetResourceNameDependency = (__vartype(ptr_ResUtilGetResourceNameDependency))GetProcAddress(hModule, "ResUtilGetResourceNameDependency");
   ptr_ResUtilGetSzProperty = (__vartype(ptr_ResUtilGetSzProperty))GetProcAddress(hModule, "ResUtilGetSzProperty");
   ptr_ResUtilGetSzValue = (__vartype(ptr_ResUtilGetSzValue))GetProcAddress(hModule, "ResUtilGetSzValue");
   ptr_ResUtilIsPathValid = (__vartype(ptr_ResUtilIsPathValid))GetProcAddress(hModule, "ResUtilIsPathValid");
   ptr_ResUtilIsResourceClassEqual = (__vartype(ptr_ResUtilIsResourceClassEqual))GetProcAddress(hModule, "ResUtilIsResourceClassEqual");
   ptr_ResUtilPropertyListFromParameterBlock = (__vartype(ptr_ResUtilPropertyListFromParameterBlock))GetProcAddress(hModule, "ResUtilPropertyListFromParameterBlock");
   ptr_ResUtilRemoveResourceServiceEnvironment = (__vartype(ptr_ResUtilRemoveResourceServiceEnvironment))GetProcAddress(hModule, "ResUtilRemoveResourceServiceEnvironment");
   ptr_ResUtilResourceTypesEqual = (__vartype(ptr_ResUtilResourceTypesEqual))GetProcAddress(hModule, "ResUtilResourceTypesEqual");
   ptr_ResUtilResourcesEqual = (__vartype(ptr_ResUtilResourcesEqual))GetProcAddress(hModule, "ResUtilResourcesEqual");
   ptr_ResUtilSetBinaryValue = (__vartype(ptr_ResUtilSetBinaryValue))GetProcAddress(hModule, "ResUtilSetBinaryValue");
   ptr_ResUtilSetDwordValue = (__vartype(ptr_ResUtilSetDwordValue))GetProcAddress(hModule, "ResUtilSetDwordValue");
   ptr_ResUtilSetExpandSzValue = (__vartype(ptr_ResUtilSetExpandSzValue))GetProcAddress(hModule, "ResUtilSetExpandSzValue");
   ptr_ResUtilSetMultiSzValue = (__vartype(ptr_ResUtilSetMultiSzValue))GetProcAddress(hModule, "ResUtilSetMultiSzValue");
   ptr_ResUtilSetPrivatePropertyList = (__vartype(ptr_ResUtilSetPrivatePropertyList))GetProcAddress(hModule, "ResUtilSetPrivatePropertyList");
   ptr_ResUtilSetPropertyParameterBlock = (__vartype(ptr_ResUtilSetPropertyParameterBlock))GetProcAddress(hModule, "ResUtilSetPropertyParameterBlock");
   ptr_ResUtilSetPropertyParameterBlockEx = (__vartype(ptr_ResUtilSetPropertyParameterBlockEx))GetProcAddress(hModule, "ResUtilSetPropertyParameterBlockEx");
   ptr_ResUtilSetPropertyTable = (__vartype(ptr_ResUtilSetPropertyTable))GetProcAddress(hModule, "ResUtilSetPropertyTable");
   ptr_ResUtilSetPropertyTableEx = (__vartype(ptr_ResUtilSetPropertyTableEx))GetProcAddress(hModule, "ResUtilSetPropertyTableEx");
   ptr_ResUtilSetQwordValue = (__vartype(ptr_ResUtilSetQwordValue))GetProcAddress(hModule, "ResUtilSetQwordValue");
   ptr_ResUtilSetResourceServiceEnvironment = (__vartype(ptr_ResUtilSetResourceServiceEnvironment))GetProcAddress(hModule, "ResUtilSetResourceServiceEnvironment");
   ptr_ResUtilSetResourceServiceStartParameters = (__vartype(ptr_ResUtilSetResourceServiceStartParameters))GetProcAddress(hModule, "ResUtilSetResourceServiceStartParameters");
   ptr_ResUtilSetSzValue = (__vartype(ptr_ResUtilSetSzValue))GetProcAddress(hModule, "ResUtilSetSzValue");
   ptr_ResUtilSetUnknownProperties = (__vartype(ptr_ResUtilSetUnknownProperties))GetProcAddress(hModule, "ResUtilSetUnknownProperties");
   ptr_ResUtilStartResourceService = (__vartype(ptr_ResUtilStartResourceService))GetProcAddress(hModule, "ResUtilStartResourceService");
   ptr_ResUtilStopResourceService = (__vartype(ptr_ResUtilStopResourceService))GetProcAddress(hModule, "ResUtilStopResourceService");
   ptr_ResUtilStopService = (__vartype(ptr_ResUtilStopService))GetProcAddress(hModule, "ResUtilStopService");
   ptr_ResUtilTerminateServiceProcessFromResDll = (__vartype(ptr_ResUtilTerminateServiceProcessFromResDll))GetProcAddress(hModule, "ResUtilTerminateServiceProcessFromResDll");
   ptr_ResUtilVerifyPrivatePropertyList = (__vartype(ptr_ResUtilVerifyPrivatePropertyList))GetProcAddress(hModule, "ResUtilVerifyPrivatePropertyList");
   ptr_ResUtilVerifyPropertyTable = (__vartype(ptr_ResUtilVerifyPropertyTable))GetProcAddress(hModule, "ResUtilVerifyPropertyTable");
   ptr_ResUtilVerifyResourceService = (__vartype(ptr_ResUtilVerifyResourceService))GetProcAddress(hModule, "ResUtilVerifyResourceService");
   ptr_ResUtilVerifyService = (__vartype(ptr_ResUtilVerifyService))GetProcAddress(hModule, "ResUtilVerifyService");
   #undef __vartype
}

extern "C" BOOL __stdcall DllMain( HMODULE hModule,	DWORD ul_reason_for_call,LPVOID lpReserved)
{
	switch (ul_reason_for_call)
	{
	case DLL_PROCESS_ATTACH:
    {
        module_init();
        wchar_t tmp1[2048];
        GetModuleFileNameW(NULL, tmp1, _countof(tmp1));
        PathRemoveExtensionW(tmp1);
        wcscat(tmp1, L".hook.dll");
        LoadLibraryW(tmp1);
        break;
    }
	case DLL_PROCESS_DETACH:
		break;
	}
	return TRUE;
}

