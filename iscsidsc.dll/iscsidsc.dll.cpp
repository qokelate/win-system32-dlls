#include <windows.h>
#include <shlwapi.h>

extern "C" {
extern void *ptr_AddISNSServerA;
void *ptr_AddISNSServerA = NULL;
extern void *ptr_AddISNSServerW;
void *ptr_AddISNSServerW = NULL;
extern void *ptr_AddIScsiConnectionA;
void *ptr_AddIScsiConnectionA = NULL;
extern void *ptr_AddIScsiConnectionW;
void *ptr_AddIScsiConnectionW = NULL;
extern void *ptr_AddIScsiSendTargetPortalA;
void *ptr_AddIScsiSendTargetPortalA = NULL;
extern void *ptr_AddIScsiSendTargetPortalW;
void *ptr_AddIScsiSendTargetPortalW = NULL;
extern void *ptr_AddIScsiStaticTargetA;
void *ptr_AddIScsiStaticTargetA = NULL;
extern void *ptr_AddIScsiStaticTargetW;
void *ptr_AddIScsiStaticTargetW = NULL;
extern void *ptr_AddPersistentIScsiDeviceA;
void *ptr_AddPersistentIScsiDeviceA = NULL;
extern void *ptr_AddPersistentIScsiDeviceW;
void *ptr_AddPersistentIScsiDeviceW = NULL;
extern void *ptr_AddRadiusServerA;
void *ptr_AddRadiusServerA = NULL;
extern void *ptr_AddRadiusServerW;
void *ptr_AddRadiusServerW = NULL;
extern void *ptr_ClearPersistentIScsiDevices;
void *ptr_ClearPersistentIScsiDevices = NULL;
extern void *ptr_DllMain;
void *ptr_DllMain = NULL;
extern void *ptr_GetDevicesForIScsiSessionA;
void *ptr_GetDevicesForIScsiSessionA = NULL;
extern void *ptr_GetDevicesForIScsiSessionW;
void *ptr_GetDevicesForIScsiSessionW = NULL;
extern void *ptr_GetIScsiIKEInfoA;
void *ptr_GetIScsiIKEInfoA = NULL;
extern void *ptr_GetIScsiIKEInfoW;
void *ptr_GetIScsiIKEInfoW = NULL;
extern void *ptr_GetIScsiInitiatorNodeNameA;
void *ptr_GetIScsiInitiatorNodeNameA = NULL;
extern void *ptr_GetIScsiInitiatorNodeNameW;
void *ptr_GetIScsiInitiatorNodeNameW = NULL;
extern void *ptr_GetIScsiSessionListA;
void *ptr_GetIScsiSessionListA = NULL;
extern void *ptr_GetIScsiSessionListEx;
void *ptr_GetIScsiSessionListEx = NULL;
extern void *ptr_GetIScsiSessionListW;
void *ptr_GetIScsiSessionListW = NULL;
extern void *ptr_GetIScsiTargetInformationA;
void *ptr_GetIScsiTargetInformationA = NULL;
extern void *ptr_GetIScsiTargetInformationW;
void *ptr_GetIScsiTargetInformationW = NULL;
extern void *ptr_GetIScsiVersionInformation;
void *ptr_GetIScsiVersionInformation = NULL;
extern void *ptr_LoginIScsiTargetA;
void *ptr_LoginIScsiTargetA = NULL;
extern void *ptr_LoginIScsiTargetW;
void *ptr_LoginIScsiTargetW = NULL;
extern void *ptr_LogoutIScsiTarget;
void *ptr_LogoutIScsiTarget = NULL;
extern void *ptr_RefreshISNSServerA;
void *ptr_RefreshISNSServerA = NULL;
extern void *ptr_RefreshISNSServerW;
void *ptr_RefreshISNSServerW = NULL;
extern void *ptr_RefreshIScsiSendTargetPortalA;
void *ptr_RefreshIScsiSendTargetPortalA = NULL;
extern void *ptr_RefreshIScsiSendTargetPortalW;
void *ptr_RefreshIScsiSendTargetPortalW = NULL;
extern void *ptr_RemoveISNSServerA;
void *ptr_RemoveISNSServerA = NULL;
extern void *ptr_RemoveISNSServerW;
void *ptr_RemoveISNSServerW = NULL;
extern void *ptr_RemoveIScsiConnection;
void *ptr_RemoveIScsiConnection = NULL;
extern void *ptr_RemoveIScsiPersistentTargetA;
void *ptr_RemoveIScsiPersistentTargetA = NULL;
extern void *ptr_RemoveIScsiPersistentTargetW;
void *ptr_RemoveIScsiPersistentTargetW = NULL;
extern void *ptr_RemoveIScsiSendTargetPortalA;
void *ptr_RemoveIScsiSendTargetPortalA = NULL;
extern void *ptr_RemoveIScsiSendTargetPortalW;
void *ptr_RemoveIScsiSendTargetPortalW = NULL;
extern void *ptr_RemoveIScsiStaticTargetA;
void *ptr_RemoveIScsiStaticTargetA = NULL;
extern void *ptr_RemoveIScsiStaticTargetW;
void *ptr_RemoveIScsiStaticTargetW = NULL;
extern void *ptr_RemovePersistentIScsiDeviceA;
void *ptr_RemovePersistentIScsiDeviceA = NULL;
extern void *ptr_RemovePersistentIScsiDeviceW;
void *ptr_RemovePersistentIScsiDeviceW = NULL;
extern void *ptr_RemoveRadiusServerA;
void *ptr_RemoveRadiusServerA = NULL;
extern void *ptr_RemoveRadiusServerW;
void *ptr_RemoveRadiusServerW = NULL;
extern void *ptr_ReportActiveIScsiTargetMappingsA;
void *ptr_ReportActiveIScsiTargetMappingsA = NULL;
extern void *ptr_ReportActiveIScsiTargetMappingsW;
void *ptr_ReportActiveIScsiTargetMappingsW = NULL;
extern void *ptr_ReportISNSServerListA;
void *ptr_ReportISNSServerListA = NULL;
extern void *ptr_ReportISNSServerListW;
void *ptr_ReportISNSServerListW = NULL;
extern void *ptr_ReportIScsiInitiatorListA;
void *ptr_ReportIScsiInitiatorListA = NULL;
extern void *ptr_ReportIScsiInitiatorListW;
void *ptr_ReportIScsiInitiatorListW = NULL;
extern void *ptr_ReportIScsiPersistentLoginsA;
void *ptr_ReportIScsiPersistentLoginsA = NULL;
extern void *ptr_ReportIScsiPersistentLoginsW;
void *ptr_ReportIScsiPersistentLoginsW = NULL;
extern void *ptr_ReportIScsiSendTargetPortalsA;
void *ptr_ReportIScsiSendTargetPortalsA = NULL;
extern void *ptr_ReportIScsiSendTargetPortalsExA;
void *ptr_ReportIScsiSendTargetPortalsExA = NULL;
extern void *ptr_ReportIScsiSendTargetPortalsExW;
void *ptr_ReportIScsiSendTargetPortalsExW = NULL;
extern void *ptr_ReportIScsiSendTargetPortalsW;
void *ptr_ReportIScsiSendTargetPortalsW = NULL;
extern void *ptr_ReportIScsiTargetPortalsA;
void *ptr_ReportIScsiTargetPortalsA = NULL;
extern void *ptr_ReportIScsiTargetPortalsW;
void *ptr_ReportIScsiTargetPortalsW = NULL;
extern void *ptr_ReportIScsiTargetsA;
void *ptr_ReportIScsiTargetsA = NULL;
extern void *ptr_ReportIScsiTargetsW;
void *ptr_ReportIScsiTargetsW = NULL;
extern void *ptr_ReportPersistentIScsiDevicesA;
void *ptr_ReportPersistentIScsiDevicesA = NULL;
extern void *ptr_ReportPersistentIScsiDevicesW;
void *ptr_ReportPersistentIScsiDevicesW = NULL;
extern void *ptr_ReportRadiusServerListA;
void *ptr_ReportRadiusServerListA = NULL;
extern void *ptr_ReportRadiusServerListW;
void *ptr_ReportRadiusServerListW = NULL;
extern void *ptr_SendScsiInquiry;
void *ptr_SendScsiInquiry = NULL;
extern void *ptr_SendScsiReadCapacity;
void *ptr_SendScsiReadCapacity = NULL;
extern void *ptr_SendScsiReportLuns;
void *ptr_SendScsiReportLuns = NULL;
extern void *ptr_SetIScsiGroupPresharedKey;
void *ptr_SetIScsiGroupPresharedKey = NULL;
extern void *ptr_SetIScsiIKEInfoA;
void *ptr_SetIScsiIKEInfoA = NULL;
extern void *ptr_SetIScsiIKEInfoW;
void *ptr_SetIScsiIKEInfoW = NULL;
extern void *ptr_SetIScsiInitiatorCHAPSharedSecret;
void *ptr_SetIScsiInitiatorCHAPSharedSecret = NULL;
extern void *ptr_SetIScsiInitiatorNodeNameA;
void *ptr_SetIScsiInitiatorNodeNameA = NULL;
extern void *ptr_SetIScsiInitiatorNodeNameW;
void *ptr_SetIScsiInitiatorNodeNameW = NULL;
extern void *ptr_SetIScsiInitiatorRADIUSSharedSecret;
void *ptr_SetIScsiInitiatorRADIUSSharedSecret = NULL;
extern void *ptr_SetIScsiTunnelModeOuterAddressA;
void *ptr_SetIScsiTunnelModeOuterAddressA = NULL;
extern void *ptr_SetIScsiTunnelModeOuterAddressW;
void *ptr_SetIScsiTunnelModeOuterAddressW = NULL;
extern void *ptr_SetupPersistentIScsiDevices;
void *ptr_SetupPersistentIScsiDevices = NULL;
extern void *ptr_SetupPersistentIScsiVolumes;
void *ptr_SetupPersistentIScsiVolumes = NULL;
}


static HMODULE hModule = NULL;
static void module_init()
{    
   if (hModule) return;
   wchar_t sz_module_file[MAX_PATH];
   GetSystemDirectoryW(sz_module_file, MAX_PATH);
   wcscat_s(sz_module_file, L"\\iscsidsc.dll");
   hModule = LoadLibraryW(sz_module_file);
   if (!hModule) return;

   #define __vartype(x) decltype(x)
   ptr_AddISNSServerA = (__vartype(ptr_AddISNSServerA))GetProcAddress(hModule, "AddISNSServerA");
   ptr_AddISNSServerW = (__vartype(ptr_AddISNSServerW))GetProcAddress(hModule, "AddISNSServerW");
   ptr_AddIScsiConnectionA = (__vartype(ptr_AddIScsiConnectionA))GetProcAddress(hModule, "AddIScsiConnectionA");
   ptr_AddIScsiConnectionW = (__vartype(ptr_AddIScsiConnectionW))GetProcAddress(hModule, "AddIScsiConnectionW");
   ptr_AddIScsiSendTargetPortalA = (__vartype(ptr_AddIScsiSendTargetPortalA))GetProcAddress(hModule, "AddIScsiSendTargetPortalA");
   ptr_AddIScsiSendTargetPortalW = (__vartype(ptr_AddIScsiSendTargetPortalW))GetProcAddress(hModule, "AddIScsiSendTargetPortalW");
   ptr_AddIScsiStaticTargetA = (__vartype(ptr_AddIScsiStaticTargetA))GetProcAddress(hModule, "AddIScsiStaticTargetA");
   ptr_AddIScsiStaticTargetW = (__vartype(ptr_AddIScsiStaticTargetW))GetProcAddress(hModule, "AddIScsiStaticTargetW");
   ptr_AddPersistentIScsiDeviceA = (__vartype(ptr_AddPersistentIScsiDeviceA))GetProcAddress(hModule, "AddPersistentIScsiDeviceA");
   ptr_AddPersistentIScsiDeviceW = (__vartype(ptr_AddPersistentIScsiDeviceW))GetProcAddress(hModule, "AddPersistentIScsiDeviceW");
   ptr_AddRadiusServerA = (__vartype(ptr_AddRadiusServerA))GetProcAddress(hModule, "AddRadiusServerA");
   ptr_AddRadiusServerW = (__vartype(ptr_AddRadiusServerW))GetProcAddress(hModule, "AddRadiusServerW");
   ptr_ClearPersistentIScsiDevices = (__vartype(ptr_ClearPersistentIScsiDevices))GetProcAddress(hModule, "ClearPersistentIScsiDevices");
   ptr_DllMain = (__vartype(ptr_DllMain))GetProcAddress(hModule, "DllMain");
   ptr_GetDevicesForIScsiSessionA = (__vartype(ptr_GetDevicesForIScsiSessionA))GetProcAddress(hModule, "GetDevicesForIScsiSessionA");
   ptr_GetDevicesForIScsiSessionW = (__vartype(ptr_GetDevicesForIScsiSessionW))GetProcAddress(hModule, "GetDevicesForIScsiSessionW");
   ptr_GetIScsiIKEInfoA = (__vartype(ptr_GetIScsiIKEInfoA))GetProcAddress(hModule, "GetIScsiIKEInfoA");
   ptr_GetIScsiIKEInfoW = (__vartype(ptr_GetIScsiIKEInfoW))GetProcAddress(hModule, "GetIScsiIKEInfoW");
   ptr_GetIScsiInitiatorNodeNameA = (__vartype(ptr_GetIScsiInitiatorNodeNameA))GetProcAddress(hModule, "GetIScsiInitiatorNodeNameA");
   ptr_GetIScsiInitiatorNodeNameW = (__vartype(ptr_GetIScsiInitiatorNodeNameW))GetProcAddress(hModule, "GetIScsiInitiatorNodeNameW");
   ptr_GetIScsiSessionListA = (__vartype(ptr_GetIScsiSessionListA))GetProcAddress(hModule, "GetIScsiSessionListA");
   ptr_GetIScsiSessionListEx = (__vartype(ptr_GetIScsiSessionListEx))GetProcAddress(hModule, "GetIScsiSessionListEx");
   ptr_GetIScsiSessionListW = (__vartype(ptr_GetIScsiSessionListW))GetProcAddress(hModule, "GetIScsiSessionListW");
   ptr_GetIScsiTargetInformationA = (__vartype(ptr_GetIScsiTargetInformationA))GetProcAddress(hModule, "GetIScsiTargetInformationA");
   ptr_GetIScsiTargetInformationW = (__vartype(ptr_GetIScsiTargetInformationW))GetProcAddress(hModule, "GetIScsiTargetInformationW");
   ptr_GetIScsiVersionInformation = (__vartype(ptr_GetIScsiVersionInformation))GetProcAddress(hModule, "GetIScsiVersionInformation");
   ptr_LoginIScsiTargetA = (__vartype(ptr_LoginIScsiTargetA))GetProcAddress(hModule, "LoginIScsiTargetA");
   ptr_LoginIScsiTargetW = (__vartype(ptr_LoginIScsiTargetW))GetProcAddress(hModule, "LoginIScsiTargetW");
   ptr_LogoutIScsiTarget = (__vartype(ptr_LogoutIScsiTarget))GetProcAddress(hModule, "LogoutIScsiTarget");
   ptr_RefreshISNSServerA = (__vartype(ptr_RefreshISNSServerA))GetProcAddress(hModule, "RefreshISNSServerA");
   ptr_RefreshISNSServerW = (__vartype(ptr_RefreshISNSServerW))GetProcAddress(hModule, "RefreshISNSServerW");
   ptr_RefreshIScsiSendTargetPortalA = (__vartype(ptr_RefreshIScsiSendTargetPortalA))GetProcAddress(hModule, "RefreshIScsiSendTargetPortalA");
   ptr_RefreshIScsiSendTargetPortalW = (__vartype(ptr_RefreshIScsiSendTargetPortalW))GetProcAddress(hModule, "RefreshIScsiSendTargetPortalW");
   ptr_RemoveISNSServerA = (__vartype(ptr_RemoveISNSServerA))GetProcAddress(hModule, "RemoveISNSServerA");
   ptr_RemoveISNSServerW = (__vartype(ptr_RemoveISNSServerW))GetProcAddress(hModule, "RemoveISNSServerW");
   ptr_RemoveIScsiConnection = (__vartype(ptr_RemoveIScsiConnection))GetProcAddress(hModule, "RemoveIScsiConnection");
   ptr_RemoveIScsiPersistentTargetA = (__vartype(ptr_RemoveIScsiPersistentTargetA))GetProcAddress(hModule, "RemoveIScsiPersistentTargetA");
   ptr_RemoveIScsiPersistentTargetW = (__vartype(ptr_RemoveIScsiPersistentTargetW))GetProcAddress(hModule, "RemoveIScsiPersistentTargetW");
   ptr_RemoveIScsiSendTargetPortalA = (__vartype(ptr_RemoveIScsiSendTargetPortalA))GetProcAddress(hModule, "RemoveIScsiSendTargetPortalA");
   ptr_RemoveIScsiSendTargetPortalW = (__vartype(ptr_RemoveIScsiSendTargetPortalW))GetProcAddress(hModule, "RemoveIScsiSendTargetPortalW");
   ptr_RemoveIScsiStaticTargetA = (__vartype(ptr_RemoveIScsiStaticTargetA))GetProcAddress(hModule, "RemoveIScsiStaticTargetA");
   ptr_RemoveIScsiStaticTargetW = (__vartype(ptr_RemoveIScsiStaticTargetW))GetProcAddress(hModule, "RemoveIScsiStaticTargetW");
   ptr_RemovePersistentIScsiDeviceA = (__vartype(ptr_RemovePersistentIScsiDeviceA))GetProcAddress(hModule, "RemovePersistentIScsiDeviceA");
   ptr_RemovePersistentIScsiDeviceW = (__vartype(ptr_RemovePersistentIScsiDeviceW))GetProcAddress(hModule, "RemovePersistentIScsiDeviceW");
   ptr_RemoveRadiusServerA = (__vartype(ptr_RemoveRadiusServerA))GetProcAddress(hModule, "RemoveRadiusServerA");
   ptr_RemoveRadiusServerW = (__vartype(ptr_RemoveRadiusServerW))GetProcAddress(hModule, "RemoveRadiusServerW");
   ptr_ReportActiveIScsiTargetMappingsA = (__vartype(ptr_ReportActiveIScsiTargetMappingsA))GetProcAddress(hModule, "ReportActiveIScsiTargetMappingsA");
   ptr_ReportActiveIScsiTargetMappingsW = (__vartype(ptr_ReportActiveIScsiTargetMappingsW))GetProcAddress(hModule, "ReportActiveIScsiTargetMappingsW");
   ptr_ReportISNSServerListA = (__vartype(ptr_ReportISNSServerListA))GetProcAddress(hModule, "ReportISNSServerListA");
   ptr_ReportISNSServerListW = (__vartype(ptr_ReportISNSServerListW))GetProcAddress(hModule, "ReportISNSServerListW");
   ptr_ReportIScsiInitiatorListA = (__vartype(ptr_ReportIScsiInitiatorListA))GetProcAddress(hModule, "ReportIScsiInitiatorListA");
   ptr_ReportIScsiInitiatorListW = (__vartype(ptr_ReportIScsiInitiatorListW))GetProcAddress(hModule, "ReportIScsiInitiatorListW");
   ptr_ReportIScsiPersistentLoginsA = (__vartype(ptr_ReportIScsiPersistentLoginsA))GetProcAddress(hModule, "ReportIScsiPersistentLoginsA");
   ptr_ReportIScsiPersistentLoginsW = (__vartype(ptr_ReportIScsiPersistentLoginsW))GetProcAddress(hModule, "ReportIScsiPersistentLoginsW");
   ptr_ReportIScsiSendTargetPortalsA = (__vartype(ptr_ReportIScsiSendTargetPortalsA))GetProcAddress(hModule, "ReportIScsiSendTargetPortalsA");
   ptr_ReportIScsiSendTargetPortalsExA = (__vartype(ptr_ReportIScsiSendTargetPortalsExA))GetProcAddress(hModule, "ReportIScsiSendTargetPortalsExA");
   ptr_ReportIScsiSendTargetPortalsExW = (__vartype(ptr_ReportIScsiSendTargetPortalsExW))GetProcAddress(hModule, "ReportIScsiSendTargetPortalsExW");
   ptr_ReportIScsiSendTargetPortalsW = (__vartype(ptr_ReportIScsiSendTargetPortalsW))GetProcAddress(hModule, "ReportIScsiSendTargetPortalsW");
   ptr_ReportIScsiTargetPortalsA = (__vartype(ptr_ReportIScsiTargetPortalsA))GetProcAddress(hModule, "ReportIScsiTargetPortalsA");
   ptr_ReportIScsiTargetPortalsW = (__vartype(ptr_ReportIScsiTargetPortalsW))GetProcAddress(hModule, "ReportIScsiTargetPortalsW");
   ptr_ReportIScsiTargetsA = (__vartype(ptr_ReportIScsiTargetsA))GetProcAddress(hModule, "ReportIScsiTargetsA");
   ptr_ReportIScsiTargetsW = (__vartype(ptr_ReportIScsiTargetsW))GetProcAddress(hModule, "ReportIScsiTargetsW");
   ptr_ReportPersistentIScsiDevicesA = (__vartype(ptr_ReportPersistentIScsiDevicesA))GetProcAddress(hModule, "ReportPersistentIScsiDevicesA");
   ptr_ReportPersistentIScsiDevicesW = (__vartype(ptr_ReportPersistentIScsiDevicesW))GetProcAddress(hModule, "ReportPersistentIScsiDevicesW");
   ptr_ReportRadiusServerListA = (__vartype(ptr_ReportRadiusServerListA))GetProcAddress(hModule, "ReportRadiusServerListA");
   ptr_ReportRadiusServerListW = (__vartype(ptr_ReportRadiusServerListW))GetProcAddress(hModule, "ReportRadiusServerListW");
   ptr_SendScsiInquiry = (__vartype(ptr_SendScsiInquiry))GetProcAddress(hModule, "SendScsiInquiry");
   ptr_SendScsiReadCapacity = (__vartype(ptr_SendScsiReadCapacity))GetProcAddress(hModule, "SendScsiReadCapacity");
   ptr_SendScsiReportLuns = (__vartype(ptr_SendScsiReportLuns))GetProcAddress(hModule, "SendScsiReportLuns");
   ptr_SetIScsiGroupPresharedKey = (__vartype(ptr_SetIScsiGroupPresharedKey))GetProcAddress(hModule, "SetIScsiGroupPresharedKey");
   ptr_SetIScsiIKEInfoA = (__vartype(ptr_SetIScsiIKEInfoA))GetProcAddress(hModule, "SetIScsiIKEInfoA");
   ptr_SetIScsiIKEInfoW = (__vartype(ptr_SetIScsiIKEInfoW))GetProcAddress(hModule, "SetIScsiIKEInfoW");
   ptr_SetIScsiInitiatorCHAPSharedSecret = (__vartype(ptr_SetIScsiInitiatorCHAPSharedSecret))GetProcAddress(hModule, "SetIScsiInitiatorCHAPSharedSecret");
   ptr_SetIScsiInitiatorNodeNameA = (__vartype(ptr_SetIScsiInitiatorNodeNameA))GetProcAddress(hModule, "SetIScsiInitiatorNodeNameA");
   ptr_SetIScsiInitiatorNodeNameW = (__vartype(ptr_SetIScsiInitiatorNodeNameW))GetProcAddress(hModule, "SetIScsiInitiatorNodeNameW");
   ptr_SetIScsiInitiatorRADIUSSharedSecret = (__vartype(ptr_SetIScsiInitiatorRADIUSSharedSecret))GetProcAddress(hModule, "SetIScsiInitiatorRADIUSSharedSecret");
   ptr_SetIScsiTunnelModeOuterAddressA = (__vartype(ptr_SetIScsiTunnelModeOuterAddressA))GetProcAddress(hModule, "SetIScsiTunnelModeOuterAddressA");
   ptr_SetIScsiTunnelModeOuterAddressW = (__vartype(ptr_SetIScsiTunnelModeOuterAddressW))GetProcAddress(hModule, "SetIScsiTunnelModeOuterAddressW");
   ptr_SetupPersistentIScsiDevices = (__vartype(ptr_SetupPersistentIScsiDevices))GetProcAddress(hModule, "SetupPersistentIScsiDevices");
   ptr_SetupPersistentIScsiVolumes = (__vartype(ptr_SetupPersistentIScsiVolumes))GetProcAddress(hModule, "SetupPersistentIScsiVolumes");
   #undef __vartype
}

extern "C" BOOL __stdcall DllMain( HMODULE hModule,	DWORD ul_reason_for_call,LPVOID lpReserved)
{
	switch (ul_reason_for_call)
	{
	case DLL_PROCESS_ATTACH:
    {
        module_init();
        wchar_t tmp1[2048];
        GetModuleFileNameW(NULL, tmp1, _countof(tmp1));
        PathRemoveExtensionW(tmp1);
        wcscat(tmp1, L".hook.dll");
        LoadLibraryW(tmp1);
        break;
    }
	case DLL_PROCESS_DETACH:
		break;
	}
	return TRUE;
}

